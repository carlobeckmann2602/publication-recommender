Draft version January 11, 2023 Typeset using L ATEXtwocolumn style in AASTeX631 TESS-Gaia Light Curve: a PSF-based TESS FFI light curve product Te Han 1, 2and Timothy D. Brandt 2 1University of California, Irvine 2University of California, Santa Barbara ABSTRACT The Transiting Exoplanet Survey Satellite (TESS) is continuing its second extended mission after 55 sectors of observations. TESS publishes full-frame images (FFI) at a cadence of 1800, 600, or 200 seconds, allowing light curves to be extracted for stars beyond a limited number of pre-selected stars. Simulations show that thousands of exoplanets, eclipsing binaries, variable stars, and other astrophysical transients can be found in these FFI light curves. To obtain high-precision light curves, we forward model the FFI with the eective point spread function to remove contamination from nearby stars. We adopt star positions and magnitudes from Gaia DR3 as priors. The resulting light curves, called TESS-Gaia Light Curves (TGLC), show a photometric precision closely tracking the pre-launch prediction of the noise level. TGLC's photometric precision reaches .2% at 16th TESS magnitude even in crowded elds. We publish TGLC Aperture and PSF light curves for stars down to 16th TESS magnitude through the Mikulski Archive for Space Telescopes (MAST) for all available sectors and will continue to deliver future light curves via 10.17909/610m-9474. The open-source package tglc is publicly available to enable any user to produce customized light curves. Keywords: Light curves (918) | Astronomy software (1855) | Astronomy databases (83) | Exoplanet astronomy (486) | Variable stars (1761) | Eclipsing binary stars (444) 1.INTRODUCTION The Transiting Exoplanet Survey Satellite (TESS) offers nearly complete sky coverage, uniform cadence, and high-precision photometry. This enables a huge amount of time-domain science, from transiting planets (Huang et al. 2018; Vanderspek et al. 2019), to eclipsing binaries (Pr sa et al. 2022; Powell et al. 2021; Borkovits et al. 2020), to stellar pulsations and variability (Antoci et al. 2019; C orsico et al. 2019; Campante et al. 2016), to exotic binaries with accretion and complex variability (Rawat et al. 2022; Pichardo Marcano et al. 2021; Hernandez et al. 2022), to blazars (Weaver et al. 2020; Raiteri et al. 2021) and supernova transients (Vallely et al. 2019; Fausnaugh et al. 2021). The headline TESS science product is its two-minute photometry processed with the ocial Science Processing Operations Center (SPOC) pipeline (Jenkins et al. 2016), but this is only available for105stars in each 27-day observed sector. Most of the TESS data volume consists of full-frame images (FFIs) binned to an 1800-second, 600-second, or 200-second cadence. Many of the aforementioned science cases require extraction of light curves from the FFIs for stars other than the pre-selected targets.TESS has the capability of reaching a photometric precision of10 2in a 30-minute exposure at 16th TESS magnitude (Ricker et al. 2015). This matches the per-epoch performance of the Zwicky Transient Facility (ZTF, Bellm et al. 2019), but TESS oers 1000 measurements over 27 days of nearly continuous viewing. However, a user seeking a TESS light curve for a 16th TESS magnitude star must currently download and process the raw full-frame images or relevant subimages with the help of TESScut (Brasseur et al. 2019) and, potentially, with a package like eleanor (Feinstein et al. 2019). Powell et al. (2022) published all TESS FFI corrected aperture light curves for stars brighter than 16th TESS magnitude without ux contamination removal, which is essential to produce reliable light curves for dim stars. Several pipelines have published individual stars' light curves on the Mikulski Archive for Space Telescopes (MAST). However, the Quick-Look Pipeline (Huang et al. 2020) and the SPOC full-frame images pipeline (Caldwell et al. 2020) only provide light curves for stars brighter than 13.5 TESS magnitude; the Cluster Difference Imaging Photometric Survey (CDIPS) and the PSF-based Approach to TESS High quality data Of Stel-arXiv:2301.03704v1 [astro-ph.IM] 9 Jan 20232 lar clusters (PATHOS) only provide a subset of TESS data (Bouma et al. 2019; Nardiello et al. 2019); eleanor and the TESS Data for Asteroseismology collaboration can return a light curve of any star in a full-frame image at the price of a degree of user involvement. Many of these pipelines remove contamination from nearby stars and adjust for the background, but systematics do remain. For all of these pipelines, the large size of TESS pixels (2100) is an intrinsic limitation that is especially problematic for faint stars and crowded elds. In addition to the large size of TESS pixels and consequent blending from nearby stars, TESS also has uctuating backgrounds from scattered sunlight, especially during certain phases of its orbit. Users interested in precise, high-cadence photometry for a fainter star must overcome all of these limitations by post-processing the full-frame images. The best extracted light curves for stars fainter than 13.5 TESS magnitude continue to require signicant user input (Feinstein et al. 2019). This paper presents a method to produce uniform, calibrated, light curves for all stars brighter than 16th TESS magnitude by leveraging astrometry and photometry from the Gaia mission. TESS and Gaia have full or nearly full-sky coverage, but their capabilities are complementary. Gaia has measured precise positions and brightnesses of about 1.5 billion stars with a Gaia Rp lter similar to that of TESS (Gaia Collaboration et al. 2021). Gaia's angular resolution of 0:002 is a factor of 100 higher than TESS's, while TESS brings a high, uniform cadence with nearly continuous coverage over its observations of each 27-day sector. The precise measurements of Gaia can enable TESS to overcome its limitations of poor angular resolution and high, uctuating backgrounds. We use Gaia astrometry and photometry to constrain the eld stars in a TESS image, build a complete and local point spread function forward model of each TESS full-frame image, and extract percent-level precise light curves of approximately 3 million stars per sector down to 16th TESS magnitude. The nal light curves of all sectors are being published in MAST's High Level Science Product (HLSP) database continuously with the release of TESS FFI. We name them TESSGaia Light Curves (TGLC). The paper is structured as follows. Section 2 discusses the existing TESS FFI pipelines and their limitations. Section 3 explains our pipeline's methodology. Section 4 examines two types of TGLC light curves. We analyze the photometric precision of TGLC in Section 5. Section 6 presents a case study of ve known exoplanets using TGLC. Section 7 describes the publication of our data product and python package. Finally, we discussthe inuence of TGLC on TESS time-domain science in Section 8. 2.EXISTING TESS FFI LIGHT CURVE PRODUCTS In this section, we give an overview of the existing sources of FFI light curves, focusing on two that provide magnitude-limited samples: the Quick-Look Pipeline (Huang et al. 2020), and eleanor (Feinstein et al. 2019). The Quick-Look Pipeline (QLP) light curves are produced with an aperture approach combined with dierence imaging. A template is rst constructed by combining many comparison frames; each FFI is then dierenced relative to this comparison frame. QLP performs aperture photometry on this dierence image and then uses the TESS magnitude to scale the dierence relative to the star's average ux. However, the nature of aperture photometry involves a tradeo: a larger aperture captures more of a star's photons, but at the cost of increased backgrounds, contaminations, and, potentially, systematics. The performance of QLP also relies on the delity of its template and, as a result, on the temporal stability of systematics. Another popular TESS FFI light curve product, eleanor , has two versions of calibrated light curves: principal component analysis (PCA) and point spread function (PSF) light curves (Feinstein et al. 2019). The aperture photometry eleanor PCA utilizes the cotrending basis vectors published by the Science Payload Operations Center (SPOC, Jenkins et al. (2016)) to remove systematics in each camera. eleanor PCA light curves are further calibrated to produce eleanor CORR. eleanor PSF uses an analytical twodimensional Gaussian model to perform PSF photometry. Users can incorporate positions of several nearby stars in the PSF t to remove contamination partially, but inputting each star's position and magnitude in the t manually becomes impractical for a full-sky light curve product. The eleanor documentation also suggests summing multiple two-dimensional Gaussians to accommodate irregular PSF shapes. However, the results are still not ideal for some irregular PSF shapes and require a higher level of user involvement. Figure 1 compares the light curve products of three pipelines: eleanor CORR, eleanor PSF, and QLP, to the ocial SPOC 2-min light curves. We adopt ve faint TESS planet hosts as our comparison stars: TOI-674 (Murgas, F. et al. 2021), LHS 3844 (Vanderspek et al. 2019), TOI-530 (Gan et al. 2021), TOI-2406 (Wells, R. D. et al. 2021), and TOI-519 (Parviainen, H. et al. 2021). We plot the light curves phase-folded around the center of their transits. The SPOC light curves are com-3 Figure 1. Light curves of ve TESS-discovered exoplanets from existing pipelines. Compared to the published work (similar to the SPOC 2-min light curves), the current FFI light curves perform poorer, especially for dimmer stars. The legend in each subplot indicates the sector(s) plotted. Light curves from extended missions are binned to a 30-minute cadence for compatible noise level with the primary mission. The periods and transit midpoints are adopted from each discovery literature. All lightcurves are detrended with wotan (Hippke et al. 2019) and the phases are normalized to 1. pared because all ve publications above use the SPOC pipeline in their discoveries of the new exoplanets. All light curves from extended missions are binned to a 30min cadence like the primary mission for a fair comparison of noise levels. All light curves are detrended with wotan , an automated detrending algorithm (Hippke et al. 2019). It is especially powerful in preserving transit signals while removing stellar trends. The detrending method is biweight, and the window length is set to 1 for all detrended light curves in this paper. For the rst two stars of 12 TESS magnitude, the FFI light curves mostly perform comparably to the 2-min light curves, but they become visibly worse for the dimmer stars. The light curves for these fainter stars have either a lower SNR, an inaccurate transit depth (compared topublished work), inconsistency among sectors, or a combination of these issues. 3.POINT SPREAD FUNCTION MODELING OF TESS FULL-FRAME IMAGES Point spread function (PSF) photometry is the most accurate way to obtain brightnesses, provided a suciently good PSF model is available. The PSF varies spatially across TESS elds, so PSF models must be t locally to address the variation. PSFs can also be timedependent, so they need to be t for each frame. However, building an accurate PSF model locally and framewise for TESS is daunting. Without prior knowledge of the positions and brightnesses of stars in the eld, PSF tting is hopelessly underconstrained: the number of4 free parameters of star positions and magnitudes can exceed the number of pixels because of the large TESS pixels. We have 1.5 billion stars in Gaia DR3, and each pixel is approximately 10 8sr, which implies 1.2 stars per pixel or 3.6 parameters to constrain with one pixel value on average. Any t for the PSF and the stellar positions would also be fundamentally nonlinear. Even if one were to ignore enough low-brightness stars to reduce the number of free parameters, the computational performance of such a nonlinear t would still be impractical for a full-sky survey. Gaia's astrometry and photometry oer a way to overcome this inability to measure the instrumental PSF. If we apply precise Gaia position and brightness measurements as xed priors, we are left with only the PSF parameters. We can construct this problem as a linear t, solvable with standard linear algebra-based approaches as shown below. Furthermore, we can include all Gaia stars in the forward modeling to resolve the background contamination as deep as 20 TESS magnitude without unduly compromising computational performance. The fundamental assumption of our PSF modeling is that the PSF shape is spatially constant over each FFI cutout of the size of about 150 150 pixels for each epoch. In practice, the PSF variation is gradual among adjacent cutouts as shown in Section 3.4, and applying the same PSF within one cutout is reasonable. We also allow the PSF to vary with time by tting each frame independently. We rst extract stellar positions and brightnesses from Gaia DR3. We then t the PSF parameters of the simulated image to the FFI cutout. Using the best-t PSF shape, we forward-model the FFI cutout with all stars except the target. Lastly, we generate a decontaminated image by subtracting this modeled cutout from the measured FFI cutout. We can then perform aperture photometry or PSF photometry on the residual to produce photometry of a given star at a given epoch. By repeating this process for all stars and all frames, we can construct FFI light curves for all stars in TESS. 3.1. Positions and Brightness from Gaia The Gaia mission has now measured positions and magnitudes of about 1.5 billion stars (Gaia Collaboration et al. 2021). The positions are typically accurate to .0.1 mas or better, while magnitude uncertainties remain0.001 mag even down to a Gaia G magnitude of 18. This extraordinary data set enables us to construct a full forward model of each TESS full-frame image. A forward model requires the positions and TESS magnitudes of all stars. We rst propagate Gaia positions from J2016.0 to the median TESS epoch of eachsector using the measured Gaia proper motions. We then convert the Gaia DR3 right ascension and declination to pixel positions based on the TESS FFI world coordinate system (WCS) headers. We do not account for either parallactic motion or perspective acceleration because both are typically orders of magnitude smaller than the proper motion correction and <0:01 TESS pixels for all but a handful of stars within a few parsecs. The positions could have small, local osets from the true coordinates due to the TESS spacecraft jitter motion. As we will show later, however, photometric products from our PSF approach are largely immune from systematic shifts over FFI cutouts. We rely only on the accurate relative positions in the TESS frame across150 TESS pixels. In addition to astrometry, our approach also requires photometric anchors for all stars in the eld. The TESS bands dier from the Gaia bands, requiring a colordependent transformation. We adopt the conversion T=G 0:00522555(GBP GRP)3 + 0:0891337(GBP GRP)2  0:633923(GBP GRP) + 0:0324473 (1) published in Stassun et al. (2019), where Tis the apparent magnitude in the TESS bandpass, and G,GBP, andGRPare Gaia bandpasses. When GBPandGRPare missing, we adopt T=G 0:430 (2) from the same work. After this step, we have astrometry and photometry in the TESS system for all Gaia stars. 3.2. Eective PSF Model With positions and magnitudes known for all stars in a TESS eld, we can forward model a full-frame image. We approach the problem agnostic to the form of the PSF, using the eective PSF (ePSF) model successfully applied to Hubble data (Anderson & King 2000). The ePSF model notes that the actual PSF observed on the detector is the convolution of the PSF incident on the detector and the detector response function. This ePSF is continuous and is the only observable form of the PSF. The ePSF may be dened at anchor points spaced more nely than the pixels on the detector and then interpolated at the position of a source. Interpolating the ePSF is equivalent to placing the PSF produced by the optics at the location of a star, multiplying by the pixel response function, and then integrating over the pixels (Anderson & King 2000). Figure 2 shows how the ePSF model works. The ePSF is shown at red anchor points and the simulated pixel5 Figure 2. Interpolation example of an ePSF model. The white squares and dots represent the pixels and their centers; the red dots represent the twice oversampled ePSF model; the dot sizes represent the ePSF values. The star represented by the red ePSF values is located at (0 ;0), the location of the largest red dot. Each pixel value (grayscale) is interpolated only by its nearest four values in the oversampled ePSF (red points) as shown in pixel (0, 1) by the white lines. This maintains the linearity (and therefore the computational efciency) of the model we use to forward model a subimage of a full-frame TESS image from an ePSF. values are interpolated among those red points. In the example gure, the ePSF is oversampled relative to the pixels on the detector by a factor of two. The size of the red points gives the intensity of the ePSF at that point, with the star centered at the point (0 ;0). The data are interpolated from the ePSF at the pixel centers, indicated in white. The grayscale color over the pixels shows these interpolated values from the ePSF, which indicate the actual intensity observed for a point source centered at (0 ;0), which in this case is displaced from the center of a pixel. The eective PSF (ePSF) method from Anderson & King (2000) interpolates the ePSF from a four-timesoversampled grid with cubic spline interpolation. Given the arbitrary nature of the oversampling factor, we explore oversampling factors from 2, 4, and 6. We decide to use a factor of 2 because it produces the best quality light curves (those derived in Section 4) and is much more computationally ecient. We also use bilinear instead of cubic interpolation. This choice enables us to write the optimization of the ePSF's values at its anchor points as a linear least-squares problem. This fact is necessary to keep the model computationally tractable. Also, we assume that the PSF of a star is mostly contained within a square with a side length of 11 pixels. Fluxes in further pixels are negligible according to TESS Instrument Handbook v0.11. In a grid with side length Lgrid= 11, the oversampled grid side length is rLgrid+ 1, where ris the oversampling factor. Depending on the position of a star to the center of its pixel, stars are interpolated by dierent sets of four interpolation points. We can now model all stars in a cutout by tting a shared local ePSF while xing stars' positions and relative uxes, but we must also consider the background to model the eld completely. The derivation of our complete model is presented in Section 3.4 after the discussion of background modeling. 3.3. Background modeling The unevenness of the TESS FFI background is a result of both stray light and CCD artifacts. Stray light from the Earth and the Moon usually produce a background with a gradient and are strongest near the ends of each observation window. The gradient is mostly linear in a small cutout and easy to t. The CCD artifacts, including the straps shown in the rst panel in Figure 3, result from highly reective metal straps beneath the CCD silicon. These straps, however, are strictly column-wise according to the TESS Instrument Handbook v0.1. We model the straps as a column-dependent ateld that applies only to a portion of the background. The visible eects of the straps are chromatic. They result from photons that penetrate the CCD, are reected, and then detected; wavelengths where the CCD is more transparent show stronger artifacts at the strap locations according to TESS Instrument Handbook v0.1. While the straps reside at specic CCD columns, they can reect photons into neighboring columns. We, therefore, model the eect of the straps as a columndependent modication to the background. We construct a at, column-dependent background by tting the variation in the background intensity between neighboring columns, applying a low-pass lter, and averaging across sectors for a given CCD. We take the dimmest half of the pixels in each column and compute the median of the ratio of the count rate between neighboring columns, using only pixels that are among the dimmest half in both columns. Multiplying these ratios across the detector produces an eective column-dependent back1https://archive.stsci.edu/les/live/sites/mast/les/home/ missions-and-data/active-missions/tess/ documents/ TESS Instrument Handbook v0.1.pdf6 Figure 3. Example of background removal of TGLC. The left panel shows a FFI cutout with a background gradient and three vertical straps. We model the background as the middle panel. The residual image on the right shows a much cleaner eld ready for an ePSF t. Note that we preserve the resolution of the color map and only shift it down by 100 e =sfor the last panel. ground. We remove drifts in the count rate across the detector by dividing by a median-ltered processing of the background. Finally, we take the median for each CCD's calibrated background over all primary mission sectors, since the straps are inherent to the CCD. The reective straps on the back of the CCD have a strong chromatic eect. To account for this, we use our calibrated CCD-dependent background as a ateld for only a fraction of the background. By allowing this fraction to be free, we t the chromaticity of the strap reections frame-by-frame. We ultimately use six parameters to model the background: a at background and a linear gradient in each of two dimensions, plus these same parameters multiplying the CCD-dependent calibrated background. Figure 3 shows an example model of the background: both the linear gradient and straps have been removed from the FFI. In particular, strap removal is essential for avoiding systematic vertical lines in ePSF shapes. 3.4. Fitting ePSF and background models Obtaining the ePSF requires a simultaneous t to all of the parameters describing the ePSF itself together with the parameters that model the background. We construct a least squares t PAFas 2 66664p1 p2 ... pm3 777752 66664a11a12   a1n a21a22   a2n ............ am1am2   amn3 777752 66664f1 f2 ... fn3 77775;(3) wherep1topmare the observed count rate of each pixel from the FFI, a11toamnare the matrix encoded with star information, and f1tofnare best ts of both the ePSF and background parameters. mis the total numFigure 4. Normalized median absolute deviation (MAD) of residual images with dierent weighting power l(Equation (4)). Larger values of pweight lower count-rate pixels more heavily in deriving the ePSF, with p= 1 weighting all pixels equally. These blue curves are generated from 196 dierent cutouts of Sector 7. The orange curve shows the MAD taken over all pixels from 196 residual images, which favors a weighting power l1:4 ber of pixels in the FFI cutout, and nis the total number of free parameters. Each star only adds weights to the rows ofA(pixels) that are 5 pixels or closer to the star; the weights for each column are the bilinear translation weights from the oversampled ePSF grid to the corresponding pixel. Weights from all stars are summed to construct the full A. We solve for Fin the least square t. For example, if we t for an 11 11 pixel ePSF (extending ve pixels from the star) and oversample by a factor of two, this requires tting n= 535 free param-7 Figure 5. 714 eective PSF models for half of Sector 1, camera 4, CCD 3. Each ePSF model is tted in a 150 150 pixels FFI cutout, and 14 14 models will exactly cover the 2048 2048 pixels image with two-pixel-wide overlaps. Each CCD is divided in this manner to produce light curves published on MAST. We can observe the gradual spatial variation of ePSF: An obvious trend is that the ePSFs are narrower in the upper right corner, which is the closest to the center of the lens. One plausible reason is the optics of the telescope produce more compact pixel response functions (PRF) near boresights according to TESS Instrument Handbook v0.1. The gradual variation supports our assumption of constant ePSF in each cutout at the beginning of Section 3. eters ((112 + 1)2+ 6). We need the number of pixels in a cutout to be much larger than the number of free parameters and for there to be many stars in the image for the t to be over-constrained. Adopting 150 150 pixel regions ( m= 22500) provides more than enough pixels to constrain the ePSF, while such a region usually has at least thousands of stars detected in Gaia. Equation (3) cannot be solved exactly if there are more pixels than parameters. The best solution depends on the denition of \ ". To allow a linear algebra solution, we take it to mean the sum of the squares of the weighted dierences between the observed and modeled pixel values. In classic 2statistics, these dierences are normalized by the observational uncertainty. In our case, we explore dierent weightings to avoid heavily prioritizing the brightest pixels and to limit our vulnerability to detector nonlinearities. We parametrize a family of weights by an exponent l, weighting each residual by 1=pl. This weighting modies Equation (3) to read 2 66664p1=pl 1 p2=pl 2 ... pm=pl m3 777752 66664a11=pl 1   a1n=pl 1 a21=pl 2   a2n=pl 2 ......... am1=pl m   amn=pl m3 777752 66664f1 f2 ... fn3 77775:(4)where we now take \ " to simply mean the sum of the squares of the residuals over all pixels. A value of l= 0:5 would approximate weighting by the uncertainty contributed by shot noise. At l= 1, each pixel is equally weighted, but this does not guarantee the smallest residual for each pixel. One advantage of our ePSF model is its high precision for faint stars, so we prioritize minimizing the residuals of dimmer pixels to enhance its performance on the faint end further. The median absolute deviation (MAD) of the residual is a natural choice of the goodness of t to represent the majority (dimmer) pixels. Figure 4 shows the normalized MAD of the residual versus dierent powers for 196 dierent cutouts sampled from Sector 7. We tested weights from l= 0:4 (prioritizing brighter pixels) to l= 2 (prioritizing dimmer pixels) and the smallest MAD happens near l= 1:4. We, therefore, adopt l= 1:4 in all ts. In addition, there are saturated pixels and dim vertical lines seemingly corresponding to bad CCD columns (dierent from the straps we discussed in Section 3.3) in some FFIs. We assign these pixels l=1(i.e. zero weight) to exclude them from the t. Figure 5 shows the resulting ePSF shapes from a part of Sector 1. The width of the ePSF gradually narrows down towards the upper-right of this CCD (the center of the camera lens) due to the TESS8 optical design. The trend shown is indeed gradual, so it is appropriate to assume the PSF is constant in each cutout. Despite the 535 parameters that we must t, the linearity of the problem results in a modest computational cost. Deriving the ePSF for a single FFI cutout requires setting up and solving a single matrix equation, and takes0.4 seconds on a single core of a modern server processor2. Processing thousands of these cutouts for each epoch, a precondition to producing light curves, takes 400 seconds for the primary mission on a single core. Extending this approach to all regions on a CCD (142), and to all CCDs on the TESS camera ( 16), brings the cost to about 350 CPU hours per primary mission sector. This remains computationally tractable on a modern server with tens of cores, requiring a wallclock time of less than a day per primary mission sector (3 days for the rst extended mission and 9 days for the second extended mission). In this way, the data may be reprocessed if needed. Deriving a local, free, non-parametric ePSF for every region of the TESS camera and every full-frame image is a linear problem, and thus a computationally tractable task. The ePSF approach to photometry has a further advantage over ts using parametric formulae, e.g., a Gaussian or a Moat model for the PSF. A Gaussian or Moffat model requires the modeled positions of all stars on the TESS image to be correct in absolute terms so that the star's center corresponds to its peak intensity. An ePSF approach has the weaker requirement that only the relative positions of the stars are correct. If all stars are oset by a fraction of a pixel, then the modeled ePSF will have its peak ux correspondingly o-center. There will be no consequence to the quality of the forward model or the extracted photometry of any star. 4.EXTRACTING LIGHT CURVES 4.1. PSF photometry light curves Our nal step after constructing the ePSF and establishing the background is to extract a light curve for each star. In previous sections, we described our ePSF t by xing the brightness of each star to its value measured by Gaia and converting it to the TESS photometric system. With the tted ePSF, we rst explore the possibility of allowing all stars in the eld to oat while extracting the light curve. As discussed in Section 3, we often have more stars than pixels in crowded elds, resulting in underconstrained ts. We try to resolve this problem by assigning Gaussian priors to eld 2AMD EPYC 7313 16-Core Processor Figure 6. Comparing the MADs of the PSF light curves if the eld stars are assigned dierent priors. All curves are normalized to their MAD at prior = 10 5, eectively xing the eld stars to the Gaia-predicted ux. Top: The MAD curves of all Sector 17 stars (black) within 20 arcminutes of TIC 270022476 (an 11.5 TESS magnitude eclipsing binary (EB); orange). Gaia DR3 2015669353645091072 is highlighted in blue, a 15.2 TESS magnitude star 1 pixel away from the EB. The trend of all stars shows a strong preference towards xing the eld stars with only several exceptions. Bottom: The comparison among EB lightcurve with xed eld stars, dim star light curve tted with xed eld stars, and dim star light curve tted with the prior that returns the lowest MAD (prior = 0.01072; red diamond in the top panel). The dim star light curve with xed eld stars shows deep transits from the EB while allowing the eld stars to oat within the best prior removes most contamination. stars while tting the target star. The priors are the fraction of each eld star's median ux derived from Gaia, so using a very small prior fundamentally sets the eld stars as non-variables. Figure 6 shows the MADs of the PSF light curves when stars are tted with dierent priors. The MADs of all stars from the vicinity of TIC 270022476 (an 11.5 TESS magnitude eclipsing binary (EB)) in Sector 17 (black) show an increasing trend as the prior gets wider, which supports choosing xed eld stars in general. Several exceptions could reach9 lower MADs at specic priors, and one of them is Gaia DR3 2015669353645091072 (blue). This dim star at 15.2 TESS magnitude is only 1 pixel away from the EB and is vulnerable to its transit contaminations if the eld stars (including the EB) are considered xed (the last row of the lower panel). If we allow the eld stars to oat with the best prior (the prior that results in the lowest MAD), most of the contamination is removed. Therefore, this approach is useful for decontaminating stars near variable sources if one nds the best prior by sampling. However, running this t requires 8000 CPU hours for a single sector due to a large number of variables, not to mention that we have to sample the priors to nd the one resulting in the largest decrease in MAD. It is thus impractical to t all light curves with this method, especially when setting all stars xed gives very high (if not the highest) precision at a very low computational cost. The function for sampling and applying priors is kept in the tglc package for manually decontaminating certain stars. We now allow the photometry of a given target star to oat while holding the photometry of its neighbors xed and keeping the ePSF derived earlier for the full 150150 pixel region. This change is equivalent to modeling a FFI cutout for each cadence and then taking the residual of this from the measured cutout. Since the eld stars are xed, the FFI cutout varies in time mainly due to background uctuation. We can then perform PSF photometry using the known ePSF on the residual images. This gives a perturbation to the ux derived from Gaia using the conversion of 15000 e =s for a 10th TESS magnitude star given in the TESS Instrument Handbook v0.1. Adding this perturbation to the Gaia-derived ux gives our PSF photometry ux of the target star. In this way, extracting a light curve for each star in the eld incurs a negligible computational cost over that for constructing the ePSF. Figure 7 illustrates the process of extracting a light curve. The left-hand panel shows a small cutout of a TESS full-frame image, a subset of that used to build the ePSF model. The middle panel shows the results of a forward model of the image xing all stars to their Gaia-inferred photometry; we have omitted the central target star from this model. The right-hand panel shows the residual from the model subimage after removing the neighboring stars (but not removing any modeled light from the target star). Performing PSF photometry on this image will produce one data point in the light curve of the target. The same can be done for all frames and all stars in this cutout to generate light curves from PSF photometry.4.2. Aperture photometry light curves We also generate TGLC Aperture light curves. Using the residual image described in Section 4.1, it is straightforward to obtain a photometric data point by summing pixels within an arbitrary aperture shape. The optimal choice of aperture is a non-trivial problem for each star. We allow manual extraction of the time series from the reduced images in our package tglc . It is possible to choose the aperture and produce customized aperture light curves. We provide an empirical arbitrary choice of 33 aperture to produce the default aperture light curves published together with the PSF light curves. Since only a part of the light from a star falls onto this aperture, the background levels of the aperture light curves need to be corrected. We estimate the median total ux of each star based on Gaia and calculate the percentage of light that shall fall onto the 3 3 pixels region based on the ePSF shape. We then shift the aperture light curve's median to the Gaia-predicted median multiplied by this percentage. While the PSF light curves have consistently high quality, aperture photometry has an edge in most conditions. Figure 8 shows three variable stars of dierent types: SX Dor is a RR Lyrae star near the outskirts of the Large Magellanic Cloud and is considered challenging to deblend by Moln ar et al. (2022); TIC 177309964 is a rapid rotator with a period of 0.4533 days (Zhan et al. 2019); AV Gru is a faint Cepheid star with a TESS magnitude of 16.94 (Plachy et al. 2021). The amplitudes of all three stars vary considerably in each cycle, but aperture light curves are more consistent across sectors than PSF light curves. The PSF light curves' inconsistent amplitudes result from their vulnerability to imperfect decontamination. As the target star gets dimmer, the remaining contamination in the residual image becomes more noticeable. These constants are added to the pixels' function as `anchor points' to drag the PSF t closer to their value. This generally reduces the amplitude of the PSF light curve variations, like the Sector 11 PSF light curve of SX Dor. Removing this artifact requires better decontamination and is thus a non-trivial task. However, the remaining constants do not aect the aperture light curve because they only aect the background level which can be easily removed as discussed in the previous paragraph. Therefore, aperture light curves have a more reliable amplitude estimation for crowded elds and dim stars. 4.3. Weighted light curves The previous two sections described two dierent methods of deriving TESS FFI light curves. Each will have slightly dierent measurement errors. The pixels10 Figure 7. Illustration of an ePSF-based t to a cutout of a TESS full-frame image. The left image is a cutout of the FFI; the middle is our forward modeling of all stars except the target star (10.5 TESS magnitude); the right image is the residual image as the dierence between the rst two images. The residual image is decontaminated and is ready to generate light curves. The unevenness in the residual image is a combined result of the imperfections of our modeling, such as constant eld stars, ePSF shape, and spatially variable background. Figure 8. TGLC light curves of 3 dierent type variable stars. TOP: SX Dor is an RR Lyrae star near the outskirts of the LMC and thus a dicult target to deblend. MID: TIC 177309964 is a rapid rotator. BOT: AV Gru is a faint Cepheid variable with a TESS magnitude of 16.94. TGLC Aperture light curves oer more reliable amplitude estimations for these highly variable stars in a crowded eld than TGLC PSF light curves. Note: These light curves are detrended with wotan with a window length of 1 day (the default for all calibrated TGLC light curves). Users should consider the non-calibrated version if dealing with long-period variable stars because such signals could be removed by detrending.11 used are the same, so the instrumental noise is shared, but the weighting of the individual pixels diers in the two approaches. As a result, we expect the measurement errors to be signicantly, but not perfectly, correlated. A linear combination of the two light curves| aperture and PSF|should have lower noise than either light curve. To explore this possibility, we introduce TGLC Weighted light curves. TGLC Weighted light curve is the weighted average of TGLC PSF and TGLC Aperture light curve. In several test elds, we nd that the weighted average of the two versions of the light curve can subtly increase photometric precision over both versions. The optimal weights to produce the highest precision light curves are elddependent, mostly correlated with the crowdedness of the eld. We lack an analytical solution for each star's best weight, so sampling is necessary for the best result. The TGLC Weighted light curves are not published with the PSF and aperture light curves, but they can be derived from these two versions with an arbitrary choice of weights. An example of the TGLC Weighted light curve precision improvement is shown in Section 5. 5.LIGHT CURVE COMPARISON In this section, we compare the light curves from TGLC to those of the QLP (Huang et al. 2020) and eleanor (Feinstein et al. 2019). We begin with the light curves of ve sample EBs that are all found in Sector 17 near NGC 7654. Figure 9 shows our TGLC PSF together with those of eleanor (Feinstein et al. 2019) and QLP (Huang et al. 2020), as well as Zwicky Transient Facility (ZTF) light curve (Bellm et al. 2019). ZTF has much better spatial resolution than TESS, greatly reducing the need to deblend in this moderately crowded eld. For all ve EBs, TGLC PSF shows the lowest noise and the best agreement with ZTF. At a TESS magnitude of 11.5, an expected comfort zone for all pipelines, QLP performs well but eleanor struggles to deblend the photometry without modeling neighboring stars' PSFs. The resulting inconsistency in eleanor is more prominent for dimmer stars: this is caused by a systematic lack in removing the contamination. An overestimate of the contamination could deepen the transit and vice versa. QLP, with its dierence imaging approach anchored to the TESS Input Catalog photometry, is relatively better for this issue, but it cuts o at 13.5 TESS magnitude. TGLC PSF also shows a smaller point-topoint scatter in its photometry, i.e., a higher photometric precision. Finally, our ePSF background t value enables us to implement quality ags that remove outliers accurately and automatically (light curves of otherpipelines may also be ltered by their quality ags). We label the frames that have background values 5 standard deviations away from the median as bad frames in the quality ag. These sudden background increases are usually caused by scattered light from the Earth and the Moon at the ends of each 14 day observation window. It is very hard to recover those irregularly contaminated frames, so we label them as low-quality frames with TGLC ag (see Appendix A.3). We next systematically analyze the photometric precision of TGLC light curves by comparing all stars in two 350350regions in Sector 7 and 17. The Sector 17 eld is relatively sparse and has an average of 0.2 Gaia stars (all magnitudes) per pixel; the Sector 7 eld is crowded with 1.2 Gaia stars per pixel on average. We assess our photometric precision using a robust estimate of the point-to-point scatter in photometry. We rst take the ux dierences between adjacent uxes ( D). The root-mean-square of this dierence is vulnerable to variable sources and outliers, so we adopt the median absolute deviation and multiply it by a factor of 1.48 (the ratio of the median absolute deviation and the standard deviation for Gaussian errors). We then divide the point-to-point scatter byp 2 to estimate the photometric precision of each point rather than on the dierence between two points. The estimated photometric precision for each light curve is then precision =1:48p 2median(jDj): (5) All of our light curves and estimated precisions refer to a single 30-minute photometric point. The top row of Figure 10 shows the comparison among TGLC Weighted (orange diamonds), QLP (green triangles), and an aperture photometry prediction from Sullivan et al. (2015) (black line). We empirically choose TGLC Weighted = 0.4 TGLC PSF + 0.6 TGLC Aperture for this analysis since these weights result in the highest precision in these elds. We derive the prelaunch prediction from Figure 14 of Sullivan et al. (2015), which summarizes the base noise level of TESS photometry. In both elds, the TGLC Weighted precision almost reaches the base noise level and displays a narrow distribution, indicating good control over systematics. QLP light curve precision closely tracks the pre-launch prediction until 13.5 TESS magnitude. We do not show eleanor on these plots. Its precision in a crowded eld surpasses that in a sparse eld. This indicates signicant uncorrected dilution, where ux from neighboring stars and backgrounds contributes to a light curve (c.f. the at eleanor light curves of TIC 270023061 in Figure 9). This dilution can be mitigated with user involvement, but it prevents straightforward12 Figure 9. Comparison of TGLC PSF light curves (rst column) with eleanor (Feinstein et al. 2019) (second and third column) and QLP (Huang et al. 2020) databases (last column) for ve sample eclipsing binaries. All light curves are detrended with wotan (Hippke et al. 2019). Stars range in brightness from 11.5 TESS magnitude (top) to 15th TESS magnitude (bottom). We omit TGLC Aperture light curves because they are indistinguishable from TGLC PSF light curves by eye. Phase-folded Zwicky Transient Facility light curves (Bellm et al. 2019) conrm the eclipse depths shown in the left column. Quality drops rapidly for other pipelines when the target gets dimmer while TGLC PSF has consistently high precision. Note that for both eleanor light curves for TIC 270023061, the transits are detected, but at a very shallow depth imperceptible in the gure. comparisons of precision across elds. The bottom row of Figure 10 compares the precision of TGLC PSF to the precision of TGLC Aperture normalized by the precision of TGLC Weighted. The TGLC Aperture has higher precision than the TGLC PSF in general (examples shown in Section 6), but TGLC PSF has an edge in sparse elds for stars dimmer than 15 TESS magnitude. The precision improvement of TGLC Weighted over the other two TGLC light curves is 20%. All three TGLC light curves reliably achieve a precision of .2% for 16th TESS magnitude stars in 30-minute data. 6.EXOPLANET LIGHT CURVES CASE STUDY We perform another case study of TGLC, analyzing its light curves for ve exoplanets from TESS's primary mission. 90% of conrmed TESS exoplanet discoveriesare from stars brighter than 12th TESS magnitude3, but there are vastly more potential exoplanet hosts dimmer than 12th TESS magnitude.Therefore, we choose ve of the faintest TESS exoplanet hosts for our case study, ranging in TESS magnitude from 11.9 to 14.3. The analysis of these examples demonstrates the potential of TGLC to enable the discovery and characterization of new exoplanets. Figure 11 and Figure 12 show ve exoplanets' TGLC PSF and TGLC Aperture light curves respectively. All light curves are binned to a 30-min cadence (for the extended mission) and are detrended with wotan (Hippke et al. 2019). Other pipelines' light curves for the same exoplanets are shown in Figure 1. Both TGLC PSF 3https://tess.mit.edu/publications/13 Figure 10. The photometric precision (Equation 5) of TGLC compared to the pre-launch prediction (Sullivan et al. 2015) in both sparse (left column) and crowded eld (right column). The highest point-to-point precision is achieved by a certain weighted average of TGLC PSF and TGLC Aperture; The shown TGLC Weighted is the photometric precision of 0.4PSF + 0.6Aperture. Top: The TGLC Weighted light curve precision (orange diamond) closely tracks the pre-launch prediction (black line) even in the crowded eld. The QLP (green triangles) precision is very close to the pre-launch prediction in the brighter end. Bottom: The precision ratio of TGLC PSF and Aperture versus TGLC Weighted. The TGLC PSF is possible to outperform TGLC Aperture in sparse eld for dim stars (the smaller the ratio is, the better), but TGLC Aperture has higher precision in other cases. and TGLC Aperture show excellent results compared to other FFI pipelines (Figure 13). Up to 3 dierent sectors of observations of each star are distinguished in the phase-folded plots to show cross-sector consistency. Both methods show steady low noise levels and consistent transit shapes for all ve exoplanets. It is challenging to maintain consistent light curves between sectors or even between two observation windows in a single sector: for example, eleanor PSF in Figure 1 has inconsistent transit depth between sectors for TOI-674 b and within a sector for TOI-519 b. Spacecraft direction changes between sectors and rotates the eld of view, which shifts and rotates all stars. The contaminations are thus dierent in each sector for the same star and require independent modeling. Only if the decontamination method is robust against dierent contaminations can consistent results be produced in dierent sectors. TGLC fully models each frame independently from Gaia priors, so it can model the change of contamination between sectors properly. We then use exoplanet (Foreman-Mackey et al. 2021) to model our light curves and the results are shown inTable 1. These light curve ts are kept to their simplest form with only the necessary free parameters (rows of Table 1). We compare our tted values of the most important orbit parameters, stellar and planet radii, and stellar masses to the published values. Four exoplanets' period ts are improved because of the extended time baseline with new sectors except LHS 3844 b, which has an ultra-short period of 0:46 days. The FFI light curves with a cadence of 10-min in Sector 27 and Sector 28 are a bit sparse for the period to converge; in contrast, SPOC 2-min light curves can be tted well with the same priors. The relatively longer cadence is an intrinsic disadvantage for FFI light curves, so we set the periods and reference transit time equal to published values from Vanderspek et al. (2019) for LHS 3844 b. Our ts mostly agree with the published values within 2 standard deviations for the other tted parameters. Since our t is a lone light curve t, we do not expect it to outperform the publication ts that use multiple instruments' data in general. However, combined with radial velocity measurement and ground-based followup photometric measurement, a comprehensive TGLC14 Figure 11. TGLC PSF light curves of 5 exoplanets in multiple sectors. Light curves of the same exoplanets from existing pipelines are shown in Figure 1. These light curves show higher precision than FFI light curves from other pipelines. Phase fold periods are adopted from Table 1 TGLC PSF periods. Note that for TOI-519 b, the PSF light curve has unreliable transit depths across sectors due to the same reason discussed in Section 4.2 exoplanet t could improve the precision of all free parameters. Our method has its limits. Comparing two TGLC light curves for TOI-519 b shows a percent-level discrepancy in transit depth for TGLC PSF. As we discussed in Section 5, TGLC PSF can achieve .2% photometric precision for a 16th TESS magnitude star; TOI-519 is 14.4 TESS magnitude so we can expect a slightly bet-ter precision. The reason for this inconsistency is the same as the variable star case we discussed in Section 4.2. It is also worth mentioning that the TGLC PSF photometry for Sector 44 and Sector 45 of TOI-530 b (Figure 11) has much fewer spikes than we see in the TGLC Aperture (Figure 12). TGLC PSF deblends better in the presence of nearby variable sources. Since PSF15 Figure 12. TGLC Aperture light curves of 5 exoplanets (same as those in Figure 11) in multiple sectors. and aperture light curves both have their advantage in certain scenarios, we publish both in our data release. 7.DATA AND AVAILABILITY All our TGLC data products are available at MAST as a High Level Science Product via 10.17909/610m-9474. The primary mission light curves are released with the paper via bulk download, and the rst extended mission sectors of TGLC are continuously produced. The ingest-ing process for the MAST portal query takes longer than bulk download, but new sectors are updated weekly. As the second extended mission sectors are available, we will continue delivering new light curves. We cut each FFI (20482048 pixels) into 14 14 cutouts, each with 150150 pixels. This leaves two-pixel-wide overlaps between cutouts to keep most stars at least 2 pixels away from the edge. Each cutout is then passed to the ePSF model and background model to calculate the best t ePSF. We then produce light curves of all stars16 Figure 13. TGLC PSF light curves of ve exoplanets in multiple sectors. Light curves of the same exoplanets of existing pipelines are shown in Figure 1. TGLCs have much higher precisions than FFI light curves from other pipelines. Phase fold periods are adopted from Table 1 TGLC PSF periods. brighter than 16th TESS magnitude, and each le includes four light curves: a PSF light curve, an aperture light curve, and their calibrated versions. The calibrated light curves are detrended and normalized with wotan (Hippke et al. 2019). The format of the light curve FITS le is detailed in Appendix A. The package tglc4is pipinstallable5and oers more customized options for light curve tting. It is best used for a small cut ( <100100 pixels) of the sky and multi-sector comparison. The user can get light curves for any star from released sectors with comparable precision to the MAST-released light curves. One can also choose to save a decontaminated 4https://doi.org/10.5281/zenodo.7023845 5https://pypi.org/project/tglc/image like the last panel in Figure 7 for customized light curve extraction. 8.DISCUSSION TESS-Gaia Light Curve achieves the photometric precision close to the instrumental noise level by incorporating the position and brightness measurements of Gaia DR3 in an eective PSF t of TESS FFI. The photometric performance that we demonstrate in Section 5 meets the noise levels assumed in predictions of TESS yields Sullivan et al. (2015). TESS full-frame images are expected to result in the discovery of thousands of transiting exoplanets, including 1000 around stars fainter than 12th TESS magnitude (Barclay et al. 2018). These predicted discoveries can be realized with the improvements in photometric precision such as those provided by TGLC.17 Table 1. Exoplanet modeling Identier TOI 674 b LHS 3844 baTOI 530 b TOI 2406 b TOI 519 b Ref. TESS magnitude11.8764 11.9238 13.5287 14.3109 14.4347 Gaia DR3b Period (days)1:97716[5] 0:46292[913]6:3875[83] 3 :0766[76] 1 :265232[0] TGLC PSF 1:97716[2] 6 :3875[82] 3 :0766[15] 1 :265233[0] TGLC Aper. 1:97714[3] 6 :3875[97] 3 :07668[96] 1 :265232[8] Literature Tc (TBJD)1546:501[4] 1325:725[58]1470:20[20] 1383 :72[33] 1493 :142[45] TGLC PSF 1546:502[0] 1470 :20[24] 1383 :3[23] 1493 :142[39] TGLC Aper. 1546:501[7] 1470 :19[98] 1383 :723[35] 1493 :142[35] Literature b0:50:2 0 :150:10 0 :280:18 0 :140:08 0 :250:15 TGLC PSF 0:40:2 0 :150:10 0 :250:18 0 :170:09 0 :220:13 TGLC Aper. 0:6240:035 0 :1860:064 0 :33+0 :08  0:11 0:16+0 :15  0:11 0:19+0 :06  0:09 Literature Rplanet (R)5:20:3 1 :320:04 8 :20:6 2 :850:16 11 :10:6 TGLC PSF 5:50:2 1 :410:04 9 :00:6 2 :300:15 12 :70:5 TGLC Aper. 5:250:17 1 :3030:022 9 :30:7 2 :94+0 :17  0:16 8:42:4 Literature Literature Ref.Murgas, F. et al. (2021)Vanderspek et al. (2019)Gan et al. (2021)Wells, R. D. et al. (2021)Parviainen, H. et al. (2021) aDue to its extremely short period, the 10-min cadence FFI data cannot t LHS 3844's period well. We xed the period and reference transit time using the literature value for this t. bGaia DR3 magnitude converted to the TESS band using the relations from the TESS Instrument Handbook v0.1 TESS full-frame images are yielding signicant scientic results despite the limitations in data precision and availability. Cataclysmic variable light curves and supernova light curves may be derived with high precision from full-frame images (Pichardo Marcano et al. 2021; Vallely et al. 2019; Fausnaugh et al. 2021). Planet searches and eclipsing binary searches have been conducted on full-frame images, but on a limited scale (Bouma et al. 2019; Nardiello et al. 2019). Other studies have had results limited by precision: Sahoo et al. (2020) discovered 28 subdwarf B stars in the southern TESS full-frame images, mostly around 14-16 TESS magnitude stars, but were able to identify asteroseismic pulsations in only two of them. These 14-16 TESS magnitude stars are precisely the ones where we achieve the largest improvements over existing pipelines. A followup study searching for eclipsing binaries and pulsating stars was further limited by crowded elds and blending (Baran et al. 2021). Our TESS-Gaia light curves overcome most limitations of blended stars down to 16th TESS magnitude. TGLC can open new horizons for TESS time-domain sciences and large-scale automated search for new periodic signals. TGLC still has several limitations that we will work to overcome in the future. The rst is the possibility of further variations in the background level at a star's loca-tion. TESS is subject to strong spatially variable backgrounds from scattered light. We will therefore measure whether a target star's ux relative to the median of its neighbors matches this ratio as observed by Gaia. If the star is brighter or fainter than expected, it could point to an under-estimated or over-estimated background, respectively. We will determine whether such a correction is needed and if so, to apply it to our light curves. The second limitation of TGLC is in deblending. Variable targets are still partially contaminating all stars nearby because our published light curves assume background stars to have constant ux. Fully deblending requires allowing all of a star's immediate neighbors to have variable uxes. We attempt this in Section 4.1 by assigning priors to eld stars, which achieves better deblending at a large computational cost. With the future release of Gaia, we may only allow the most variable eld stars to oat and keep the number of free parameters under a reasonable number to improve performance. With the release of Gaia DR3, including individual photometric time series in the vicinity of the Andromeda Galaxy, we plan to check our time series photometry against individual Gaia measurements. Gaia DR4 lacks an expected release date, but it will include thousands of photometric data points for nearly every star brighter than 20 TESS magnitude. These light curves will form18 a coarsely sampled, but precise, check on the TESS photometry. They will serve as a verication of the deblending performed by the TESS-Gaia pipeline. We are grateful to Ben Montet and Chelsea Huang for their suggestions regarding the development of our method. We acknowledge James Davenport for his early inspiration. We are thankful to Hannah M. Lewis and Scott W. Fleming for their help with data publication on MAST. We thank Corey Beard for helping with the exoplanet tting. We appreciate Aomawa Shields and Paul Robertson for their comments on this paper. We thank Mirek Brandt for his help in inspecting documentation for tglc . We value the conversation about FFI WCS with Clara E. Brasseur. We are grateful for the revision advice from the anonymous reviewer. T.D.B. gratefully acknowledges support from the Heising-Simons Foundation under grant #2019-1493 and from the Alfred P. Sloan Foundation.1 2 3 4 5 6 7 8 9 10 11 12 13 14 15Our pipeline uses numpy (van der Walt et al. 2011), scipy (Jones et al. 2001), astropy (Astropy Collaboration et al. 2013, 2018), and astroquery (Ginsburg et al. 2019). This research made use of exoplanet (ForemanMackey et al. 2021; Foreman-Mackey et al. 2021) and its dependencies (Foreman-Mackey et al. 2017; ForemanMackey 2018; Agol et al. 2020; Kumar et al. 2019; Astropy Collaboration et al. 2013, 2018; Kipping 2013a,b; Luger et al. 2019; Salvatier et al. 2016; Theano Development Team 2016). APPENDIX A.TGLC DATA PRODUCT DESCRIPTION The TESS Gaia Light Curves (TGLC) are published in MAST as a High Level Science Product (HLSP). The primary mission light curves are published with the paper and the following light curves are continuously produced. We follow the standard TESS light curve FITS le convention and make necessary adjustments. We describe the format of our data product in this appendix to help users utilize them eciently. The most up-to-date information about the data product can be found in TGLC GitHub repository6. A.1. File format TGLC FITS les follow the naming convention of HLSP: hlsp tglctessgaiaid-fGaia DR3 IDg-sfsector numberg-camfcamera numberg-ccdfCCD numbergtessv1llc.ts Each FITS le has two Header Data Units (HDUs). The primary HDU is only used when generating light curves with the option save aper=True when running tglc . All light curves on HLSP have empty primary HDU. The secondary HDU includes the light curves in a binary table. A.2. Light curve headers The primary header includes the Gaia measurements of the star and the TESS FFI information. The secondary header includes uncertainties of the light curves and other PSF t parameters. Table 2 and 3 are the headers of TOI-519 b Sector 7 light curve. Table 2 . Primary Headers Header Card Default/Example Value Data Type Description SIMPLE True bool conforms to FITS standard BITPIX 8 int 8 / array data type Table 2 continued 6https://github.com/TeHanHunter/TESS Gaia Light Curve19 Table 2 (continued) Header Card Default/Example Value Data Type Description NAXIS 0 int 0 / number of array dimensions EXTEND True bool NEXTEND 1 int number of standard extensions EXTNAME `PRIMARY' str name of extension EXTDATA `aperture' str decontaminated FFI cut for aperture photometry EXTVER 1 int extension version TIMESYS `TDB' str TESS Barycentric Dynamical Time BUNIT `e-/s' str ux unit STAR X 1.511527631847869 oat star x position in cuta STAR Y 1.963850491691666 oat star y position in cuta COMMENT hdul[0].data[:,star y,star x]=lc ORIGIN `UCSB/TGLC' str institution responsible for creating this le TELESCOP `TESS' str telescope INSTRUME `TESS Photometer' str detector type FILTER `TESS' str the lter used for the observations OBJECT `Gaia DR3 5707485527450614656' str string version of Gaia DR3 ID GAIADR3 = 5707485527450614656 int integer version of Gaia DR3 ID TICID `218795833' str TESS Input Catalog ID SECTOR 7 int observation sector CAMERA 2 int camera No. CCD 3 int CCD No. CUT X 0 int FFI cut x index CUT Y 0 int FFI cut y index CUTSIZE 90 int FFI cut size RADESYS `ICRS' str reference frame of celestial coordinates RAOBJ 124.6067520456133 oat [deg] right ascension, J2000 DEC OBJ = -19.66278772837456 oat [deg] declination, J2000 TESSMAG = 14.54195107475864 oat TESS magnitude, tted by Gaia DR3 bandsb GAIA G 15.67702007293701 oat Gaia DR3 g band magnitude GAIA BP = 17.19266128540039 oat Gaia DR3 bp band magnitude GAIA RP = 14.48194599151611 oat Gaia DR3 rp band magnitude RAWFLUX = 147.7626953125 oat median ux of raw FFI CALIB `TGLC' str pipeline used for image calibration aPixel position of the star in the 5*5 cutout if save aper=True bCaculated with Equation 1.20 Table 3 . Secondary Headersa Header Card Default/Example Value Data Type Description TIMEREF `SOLARSYSTEM' str barycentric correction applied to times TASSIGN `SPACECRAFT' str where time is assigned BJDREFI 2457000 int integer part of BJD reference date BJDREFR 0.0 oat fraction of the day in BJD reference date TIMEUNIT `d' str time unit for TIME TELAPS 24.41693964503611 oat [d] TSTOP-TSTART TSTART 1491.661149617617 oat [d] observation start time in TBJD TSTOP 1516.078089262653 oat [d] observation end time in TBJD MJD BEG 58491.16114961762 oat [d] start time in barycentric MJD MJD END 58515.57808926265 oat [d] end time in barycentric MJD TIMEDEL 0.02248336983889145 oat [d] time resolution of data XPTIME 1800 int [s] exposure time PSF ERR 3.37816157065132 oat [e-/s] PSF ux error APER ERR 1.880864044956725 oat [e-/s] aperture ux error CPSF ERR 0.01337824161713607 oat [e-/s] calibrated PSF ux errorb CAPE ERR 0.007316015100534172 oat [e-/s] calibrated aperture ux errorb NEAREDGE False bool distance to edges of FFI <= 2c LOC BG -292.0021735884076 oat [e-/s] locally modied background COMMENT str TRUE BG = hdul[1].data['background'] + LOC BG WOTAN WL 1 int wotan detrending window length WOTAN MT `biweight' str wotan detrending method aWe omit light curve extension headers and duplicate rows from the Primary header. Light curve extensions are discussed separately in A.3. bAs discussed at the end of Section 6, the calibrated aperture ux has an almost halved uncertainty compared to the calibrated PSF ux for this light curve. cNEAREDGE indicates whether the star is 2 pixels or closer to the edge of the FFI. If True, the PSF light curves can not be tted, and only the aperture light curves are available. A.3. Light curve extensions The light curve is stored in the second HDU as a binary table. All columns are listed in Table 4. The calibrated uxes are ready for transit detections; the uncalibrated uxes are best for variable star sciences. The PSF light curves usually provide better deblending, but the aperture light curves oer higher precision and a more consistent amplitude if the target is in a crowded eld. The background t shows the background variation and could indicate stray light from the Earth and the Moon. The cadence number is the cadence of the FFI. The TESS ag follows the FFI convention 7. The TGLC ag has only the rst bit monitoring the presence of stray light, which is achieved by marking cadences with backgrounds at least ve standard deviations from the median background. 7https://outerspace.stsci.edu/display/TESS/2.0+-+Data+ Product+Overview21 Table 4. Light curve extensions Column Name Data Type Description 1 time numpy.ndarray Time (TBJD) 2 psf ux numpy.ndarray PSF ux ( e / s) 3 aperture ux numpy.ndarray Aperture ux ( e / s) 4 cal psfux numpy.ndarray Calibrated PSF ux (normalized and detrended) 5 cal aper ux numpy.ndarray Calibrated aperture ux (normalized and detrended) 6 background numpy.ndarray Fitted background value ( e / s) 7 cadence num numpy.ndarray FFI cadence number 8 TESS ags numpy.ndarray FFI quality ags (directly from FFI) 9 TGLC ags numpy.ndarray TGLC ags22 REFERENCES Agol, E., Luger, R., & Foreman-Mackey, D. 2020, AJ, 159, 123, doi: 10.3847/1538-3881/ab4fee Anderson, J., & King, I. R. 2000, PASP, 112, 1360, doi: 10.1086/316632 Antoci, V., Cunha, M. S., Bowman, D. M., et al. 2019, MNRAS, 490, 4040, doi: 10.1093/mnras/stz2787 Astropy Collaboration, Robitaille, T. P., Tollerud, E. J., et al. 2013, A&A, 558, A33, doi: 10.1051/0004-6361/201322068 Astropy Collaboration, Price-Whelan, A. M., Sip} ocz, B. M., et al. 2018, AJ, 156, 123, doi: 10.3847/1538-3881/aabc4f Baran, A. S., Sahoo, S. K., Sanjayan, S., & Ostrowski, J. 2021, MNRAS, 503, 3828, doi: 10.1093/mnras/stab668 Barclay, T., Pepper, J., & Quintana, E. V. 2018, ApJS, 239, 2, doi: 10.3847/1538-4365/aae3e9 Bellm, E. C., Kulkarni, S. R., Graham, M. J., et al. 2019, PASP, 131, 018002, doi: 10.1088/1538-3873/aaecbe Borkovits, T., Rappaport, S. A., Tan, T. G., et al. 2020, MNRAS, 496, 4624, doi: 10.1093/mnras/staa1817 Bouma, L. G., Hartman, J. D., Bhatti, W., Winn, J. N., & Bakos, G. A. 2019, ApJS, 245, 13, doi: 10.3847/1538-4365/ab4a7e Brasseur, C. E., Phillip, C., Fleming, S. W., Mullally, S. E., & White, R. L. 2019, Astrocut: Tools for creating cutouts of TESS images, Astrophysics Source Code Library, record ascl:1905.007. http://ascl.net/1905.007 Caldwell, D. A., Tenenbaum, P., Twicken, J. D., et al. 2020, Research Notes of the American Astronomical Society, 4, 201, doi: 10.3847/2515-5172/abc9b3 Campante, T. L., Schoeld, M., Kuszlewicz, J. S., et al. 2016, ApJ, 830, 138, doi: 10.3847/0004-637X/830/2/138 C orsico, A. H., Althaus, L. G., Miller Bertolami, M. M., & Kepler, S. O. 2019, A&A Rv, 27, 7, doi: 10.1007/s00159-019-0118-4 Fausnaugh, M. M., Vallely, P. J., Kochanek, C. S., et al. 2021, ApJ, 908, 51, doi: 10.3847/1538-4357/abcd42 Feinstein, A. D., Montet, B. T., Foreman-Mackey, D., et al. 2019, PASP, 131, 094502, doi: 10.1088/1538-3873/ab291c Foreman-Mackey, D. 2018, Research Notes of the American Astronomical Society, 2, 31, doi: 10.3847/2515-5172/aaaf6c Foreman-Mackey, D., Agol, E., Ambikasaran, S., & Angus, R. 2017, AJ, 154, 220, doi: 10.3847/1538-3881/aa9332 Foreman-Mackey, D., Luger, R., Agol, E., et al. 2021, arXiv e-prints, arXiv:2105.01994. https://arxiv.org/abs/2105.01994 Foreman-Mackey, D., Savel, A., Luger, R., et al. 2021, exoplanet-dev/exoplanet v0.5.1, doi: 10.5281/zenodo.1998447Gaia Collaboration, Brown, A. G. A., Vallenari, A., et al. 2021, A&A, 649, A1, doi: 10.1051/0004-6361/202039657 Gan, T., Lin, Z., Wang, S. X., et al. 2021, Monthly Notices of the Royal Astronomical Society, 511, 83, doi: 10.1093/mnras/stab3708 Ginsburg, A., Sip} ocz, B. M., Brasseur, C. E., et al. 2019, AJ, 157, 98, doi: 10.3847/1538-3881/aafc33 Hernandez, M. S., Schreiber, M. R., Parsons, S. G., et al. 2022, MNRAS, 512, 1843, doi: 10.1093/mnras/stac604 Hippke, M., David, T. J., Mulders, G. D., & Heller, R. 2019, AJ, 158, 143, doi: 10.3847/1538-3881/ab3984 Huang, C. X., Burt, J., Vanderburg, A., et al. 2018, ApJL, 868, L39, doi: 10.3847/2041-8213/aaef91 Huang, C. X., Vanderburg, A., P al, A., et al. 2020, Research Notes of the American Astronomical Society, 4, 204, doi: 10.3847/2515-5172/abca2e Jenkins, J. M., Twicken, J. D., McCauli, S., et al. 2016, in Society of Photo-Optical Instrumentation Engineers (SPIE) Conference Series, Vol. 9913, Software and Cyberinfrastructure for Astronomy IV, ed. G. Chiozzi & J. C. Guzman, 99133E, doi: 10.1117/12.2233418 Jenkins, J. M., Twicken, J. D., McCauli, S., et al. 2016, in Software and Cyberinfrastructure for Astronomy IV, ed. G. Chiozzi & J. C. Guzman, Vol. 9913, International Society for Optics and Photonics (SPIE), 1232 { 1251, doi: 10.1117/12.2233418 Jones, E., Oliphant, T., & Peterson, P. 2001, SciPy: Open Source Scientic Tools for Python. http://www.scipy.org Kipping, D. M. 2013a, MNRAS, 435, 2152, doi: 10.1093/mnras/stt1435 |. 2013b, MNRAS, 434, L51, doi: 10.1093/mnrasl/slt075 Kumar, R., Carroll, C., Hartikainen, A., & Martin, O. A. 2019, The Journal of Open Source Software, doi: 10.21105/joss.01143 Luger, R., Agol, E., Foreman-Mackey, D., et al. 2019, AJ, 157, 64, doi: 10.3847/1538-3881/aae8e5 Moln ar, L., B odi, A., P al, A., et al. 2022, ApJS, 258, 8, doi: 10.3847/1538-4365/ac2ee2 Murgas, F., Astudillo-Defru, N., Bonls, X., et al. 2021, A&A, 653, A60, doi: 10.1051/0004-6361/202140718 Nardiello, D., Borsato, L., Piotto, G., et al. 2019, MNRAS, 490, 3806, doi: 10.1093/mnras/stz2878 Parviainen, H., Palle, E., Zapatero-Osorio, M. R., et al. 2021, A&A, 645, A16, doi: 10.1051/0004-6361/202038934 Pichardo Marcano, M., Rivera Sandoval, L. E., Maccarone, T. J., & Scaringi, S. 2021, MNRAS, 508, 3275, doi: 10.1093/mnras/stab268523 Plachy, E., P al, A., B odi, A., et al. 2021, The Astrophysical Journal Supplement Series, 253, 11, doi: 10.3847/1538-4365/abd4e3 Powell, B. P., Kostov, V. B., Rappaport, S. A., et al. 2021, AJ, 161, 162, doi: 10.3847/1538-3881/abddb5 Powell, B. P., Kruse, E., Montet, B. T., et al. 2022, Research Notes of the American Astronomical Society, 6, 111, doi: 10.3847/2515-5172/ac74c4 Pr sa, A., Kochoska, A., Conroy, K. E., et al. 2022, ApJS, 258, 16, doi: 10.3847/1538-4365/ac324a Raiteri, C. M., Villata, M., Larionov, V. M., et al. 2021, MNRAS, 504, 5629, doi: 10.1093/mnras/stab1268 Rawat, N., Pandey, J. C., Joshi, A., & Yadava, U. 2022, MNRAS, 512, 6054, doi: 10.1093/mnras/stac844 Ricker, G. R., Winn, J. N., Vanderspek, R., et al. 2015, Journal of Astronomical Telescopes, Instruments, and Systems, 1, 014003, doi: 10.1117/1.JATIS.1.1.014003 Sahoo, S. K., Baran, A. S., Sanjayan, S., & Ostrowski, J. 2020, MNRAS, 499, 5508, doi: 10.1093/mnras/staa2991 Salvatier, J., Wiecki, T. V., & Fonnesbeck, C. 2016, PeerJ Computer Science, 2, e55 Stassun, K. G., Oelkers, R. J., Paegert, M., et al. 2019, The Astronomical Journal, 158, 138, doi: 10.3847/1538-3881/ab3467Sullivan, P. W., Winn, J. N., Berta-Thompson, Z. K., et al. 2015, ApJ, 809, 77, doi: 10.1088/0004-637X/809/1/77 Theano Development Team. 2016, arXiv e-prints, abs/1605.02688. http://arxiv.org/abs/1605.02688 Vallely, P. J., Fausnaugh, M., Jha, S. W., et al. 2019, MNRAS, 487, 2372, doi: 10.1093/mnras/stz1445 van der Walt, S., Colbert, S. C., & Varoquaux, G. 2011, Computing in Science &amp Engineering, 13, 22, doi: 10.1109/mcse.2011.37 Vanderspek, R., Huang, C. X., Vanderburg, A., et al. 2019, The Astrophysical Journal, 871, L24, doi: 10.3847/2041-8213/aafb7a Weaver, Z. R., Williamson, K. E., Jorstad, S. G., et al. 2020, ApJ, 900, 137, doi: 10.3847/1538-4357/aba693 Wells, R. D., Rackham, B. V., Schanche, N., et al. 2021, A&A, 653, A97, doi: 10.1051/0004-6361/202141277 Zhan, Z., G unther, M. N., Rappaport, S., et al. 2019, The Astrophysical Journal, 876, 127, doi: 10.3847/1538-4357/ab158c