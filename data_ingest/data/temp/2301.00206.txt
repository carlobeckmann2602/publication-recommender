arXiv:2301.00206v1 [math.DS] 31 Dec 2022Melnikov’s persistence in degeneracy of high co-dimension . Jiayin Dua1, Yong Lia,b2 aCollege of Mathematics, Jilin University, Changchun 13001 2, P. R. China. bSchool of Mathematics and Statistics, and Center for Mathem atics and Interdisciplinary Sciences, Northeast Normal University, Changchun 130024, P. R. China. Abstract In this paper, we study the Melnikov’s persistence about low er-dimensional invariant tori for degenerate Hamiltonian systems with the following Hamiltonian H(x,y,u,v)=h(y)+g(u,v)+εP(x,y,u,v),(x,y,u,v)∈Tn×G×Rd×Rd, where n≥2 and d≥1 are positive integers, g=o(|u|2+|v|2) admits certain transversality, and G⊂Rnis a bounded closed region. This is a try in studying lower-dimen sional invariant tori in the normal degeneracy of high co-dimension, i.e., d>1. Under R¨ ussmann-like non-degenerate condition and tran sversality condition, we apply the homotopy invariance of topological degree to remove the ﬁrs t order terms about uandvand employ the quasi-linear KAM iterative procedure. Keywords: Degenerate Hamiltonian system, lower-dimensional tori, M elnikov’s persistence, high co-dimension. Contents 1 Introduction 2 2 Main Results 3 3 KAM Step 6 3.1 Description of the 0-th KAM step. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 3.2 Induction from ν-th KAM step . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 3.2.1 Description of the ν-th KAM step . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 3.2.2 Construct a symplectic transformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 3.2.3 Truncation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 3.2.4 Homological Equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10 3.2.5 Translation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13 3.2.6 Eliminate the ﬁrst order terms about z. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13 3.2.7 Estimate on N+. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15 3.2.8 Estimate on Φ+. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16 3.2.9 Frequency Property . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19 3.2.10 Estimate on P+. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20 4 Proof of Theorem 1 21 4.1 Iteration Lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21 4.2 Convergence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25 4.3 Measure estimate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27 1E-mail address : dujy20@mails.jlu.edu.cn 2Corresponding author’s e-mail address : liyong@jlu.edu.c n Preprint submitted to a January 3, 20235 Appendix A. 28 6 Appendix B. 29 1. Introduction It is well known that by the classical KAM theory [ 1,12,21,29,32], most non-resonant Lagrangian tori of a non-degenerate integrable Hamiltonian system survive sma ll perturbations with only slight deformation. In contrast to this, the destruction of those resonant tori appears inev itable under perturbations in general. Nevertheless, thei r disintegration does not imply the nonexistence of regular m otions such as periodic or quasi-periodic motions, as pointed out in [ 5]. Some studies indicate that the resonant torus foliated by non-resonant lower-dimensional tori is not destroyed completely and that there are some lower-dimensi onal tori which survive perturbation if the Hamiltonian satisﬁes a certain non-degenerate condition, see [ 8,24,27,36,39]. So, in the perturbation theory of Hamiltonian systems, the persistence of lower-dimensional invariant t ori plays an important role in understanding the destructio n mechanism of resonant Lagrangian tori. Let’s consider the unperturbed system with the following no rmal form: N=/a\}b∇acketle{tω,y/a\}b∇acket∇i}ht+1 2/a\}b∇acketle{tz,Ωz/a\}b∇acket∇i}ht, where ( y,z)∈Rn×R2d,n≥2,d≥1. In non-degenerate case, i.e., Ωis non-singular, if all the eigenvalues of JΩ belong to iR1\{0}(Jis the standard symplectic matrix), we say that the lower-di mensional invariant torus is elliptic, which corresponds to the following normal form: N=/a\}b∇acketle{tω,y/a\}b∇acket∇i}ht+1 2d/summationdisplay j≥1Ωj(u2 j+v2 j), where ( y,z)∈Rn×R2d,z=(u,v)∈Rd×Rd. In 1965, Melnikov [ 28] announced that the elliptic lower dimensional invariant tori can persist for any small perturbations unde r certain coupling nonresonance conditions, called Melnik ov conditions: /a\}b∇acketle{tk,ω/a\}b∇acket∇i}ht+/a\}b∇acketle{tl,Λ/a\}b∇acket∇i}ht/nequal0,∀(k,l)∈(Zn×Z2d)\{0},|l|≤2, whereΛis the column vector formed by the eigenvalues of Ω. A detailed and rigorous proof of the above Melnikov’s theorem was due to Eliasson [ 13] and then an inﬁnite dimensional analogue was obtained by Ku ksin [ 23], P¨ oschel [33], Bourgain [ 2] and Wayne [ 41]. On the other hand, if all the eigenvalues of JΩare not on the imaginary axis, the lower-dimensional invariant torus is called hyperbolic, w hich is associated with the unperturbed system N=/a\}b∇acketle{tω,y/a\}b∇acket∇i}ht+1 2d/summationdisplay j≥1Ωj(u2 j−v2 j). The persistence problem for hyperbolic tori was ﬁrst consid ered in the work of Moser [ 30] and later studied by Gra ﬀ [17] and Zehnder [ 46] for a ﬁxed toral frequency ωsatisfying the following Diophantine condition: |/a\}b∇acketle{tk,ω/a\}b∇acket∇i}ht|>γ |k|τ,k∈Zn\{0}, (1.1) where k=(k1,···,kn),|k|=|k1|+···+|kn|,γ> 0 andτ>n−1. Moreover, the persistence of lower-dimensional invariant tori has been extensively studied in various (nor mally) non-degenerate cases, see [ 3,4,5,6,8,9,10,11, 13,14,15,20,26,28,33,35,39] and references therein. However, in degenerate case, i.e. ,Ωis singular, generally, the lower dimensional invariant tori might be destroyed und er small perturbations. Then a natural question is what degenerate systems admit Melnikov’s persistence, which is an essential problem, for example, see [ 22]. A normal form in the simplest degenerate case is, see Takens [ 38], N=/a\}b∇acketle{tω,y/a\}b∇acket∇i}ht+1 2v2+f(u,v), 2where y∈Rn,f(u,v)=o(|u|2+|v|2)/nequal0,u,v∈R1, which is called co-dimension 1. You in [ 45] proved the persistence of a hyperbolic-type degenerate lower-dimensional torus f or co-dimension 1 Hamiltonian systems with the following normal form N=/a\}b∇acketle{tω,y/a\}b∇acket∇i}ht+1 2v2−u2l,l≥2, where ( y,u,v)∈Rn×R1×R1. For more details see [ 42,43]. Recently, Li and Yi showed the persistence of lowerdimensional tori of general types, under a Melnikov-type of non-resonance condition, for the Hamiltonian system with the following general normal form N=e+/a\}b∇acketle{tω,y/a\}b∇acket∇i}ht+1 2/a\}b∇acketle{t/parenleftiggy z/parenrightigg ,M/parenleftiggy z/parenrightigg /a\}b∇acket∇i}ht+O(|(y,z)|3), where ( y,z)∈Rn×R2d,d≥1, and Mis nonsingular. For some other related studies, see [ 16,18,19,44]. In this paper, we will consider the Melnikov’s persistence when the unperturbed systems possess both high-degeneracy and high co-dimension. More precisely, we consider the following more general dege nerate Hamiltonian system H(x,y,u,v)=h(y)+g(u,v)+εP(x,y,u,v), (1.2) where n≥2 and d≥1 are positive integers, ( x,y,u,v)∈Tn×G×Rd×Rd,Tnis the standard n-torus, G⊂Rnis a bounded closed region, g=o(|u|2+|v|2),h,gandPare real analytic functions in ( x,y,u,v),ε>0 is a small parameter andεPis the small perturbation. We verify the persistence of lowe r-dimensional invariant tori for the degenerate Hamiltonian system with high co-dimension under certain hi gh degeneracy conditions. We further construct some suﬃcient conditions in term of the topological degree conditio n as well as the weak convexity condition for g(u,v), see(A0) in Section 2for details of these two conditions. We also give an example t o state that our condition (A0) is sharp to Melnikov’s persistence, see Proposition 2. The paper is organized as follows. In Section 2, we state our main results (Theorem 1, Proposition 1and Proposition 2). Section 3contains the detailed construction and estimates for one cy cle of KAM steps. In Section 4, we complete the proof of Theorem 1by deriving an iteration lemma and showing the convergence o f KAM iterations. Finally, the proof of Proposition 1and Proposition 2can be found in Appendix A and Appendix B, respectively. 2. Main Results To state our main results we need ﬁrst to introduce a few deﬁni tions and notations. •Given a domain D, we let ¯D,∂Ddenote the closure of Dand the boundary of D, respectively. Do:=¯D\∂D refers to the interior. •We shall use the same symbol |·|to denote the Euclidean norm of vectors, and use |·|Dto denote the supremum norm of a function on a domain D. •For any two complex column vectors ξ,ηof the same dimensional, /a\}b∇acketle{tξ,η/a\}b∇acket∇i}htalways stands for ξ⊤η, i.e., the transpose ofξtimesη. •idis the identical mapping, and Idis the d-order unit matrix. •For a vector value function f,D fdenotes the Jacobian matrix of f, and Jf=detD f its Jacobian determinant. •All Hamiltonians in the sequel are endowed with the standard symplectic structure. •Bδ(ζ) stands for a sphere with ζas center andδas radius. •For simplicity we let z=(u,v)∈R2d,∇g(z)=(∂g ∂u,∂g ∂v). 3•Denote the complex neighborhoods of Tn×{0}×{0} D(s,r)={(x,y,z) :|Imx|<r,|y|<s2,|z|<s} (2.1) with 0<s,r<1. LetΩ⊂Rnbe a bounded and open domain. We give the deﬁnition of the degr ee for f∈C2(¯Ω,Rn), see [ 31]. Deﬁnition 2.1. If f∈C2(¯Ω,Rn)and p∈Rn\f(∂Ω). (1) Denote N f={x∈Ω|Jf(x)=0}. If p/nelementf(Nf), then deg( f,Ω,p) :=/summationdisplay x∈f−1(p)sign(Jf(x)), setting deg( f,Ω,p)=0if f−1(p)=Ø. (2) If p∈f(Nf), by Sard theorem (see [ 31]),deg( f,Ω,p)is deﬁned as deg( f,Ω,p) :=deg( f,Ω,p1), for some ( and all) p 1/nelementf(Nf)such that|p1−p|≪1. Letξ∈Gbe arbitrarily given. The Taylor expansion of the Hamiltoni an (1.2) aboutξin a small neighborhood of ξinGreads H(x,y,z,ξ)=e(ξ)+/a\}b∇acketle{tω(ξ),y−ξ/a\}b∇acket∇i}ht+˜h(y−ξ)+g(z)+εP(x,y,z), where e(ξ)=h(ξ),ω(ξ)=∂h(ξ) ∂y, and ˜h(y−ξ)=O(|y−ξ|2). Using the transformation ( y−ξ)→yin the above, we have H(x,y,z,ξ)=e(ξ)+/a\}b∇acketle{tω(ξ),y/a\}b∇acket∇i}ht+˜h(y,ξ)+g(z)+εP(x,y,z,ξ), where ( x,y,z)∈D(s,r),ξ∈G. We are ﬁnally led to consider the following Hamiltonian /braceleftiggH:Tn×G×R2d×G→R1, H(x,y,z,ξ)=e(ξ)+/a\}b∇acketle{tω(ξ),y/a\}b∇acket∇i}ht+˜h(y,ξ)+g(z)+εP(x,y,z,ξ).(2.2) First, we make the following assumptions: (A0) For ﬁxζ0=0∈Oo⊂R2d, where Ois a bounded closed domain, there are σ>0,L≥2 such that deg(∇g(z)−∇g(ζ0),Oo,0)/nequal0, |∇g(z)−∇g(ζ0)|≥σ|z−ζ0|L. (A1) There is a positive integer Msuch that rank{∂i ξA0(ξ) : 0≤|i|≤M}=1f or allξ∈G, where A0(ξ)=/a\}b∇acketle{tk |k|,ω(ξ)/a\}b∇acket∇i}ht,k∈Zn\{0},|k|=|k1|+···+|kn|. We can now state our main results: Theorem 1. Consider the Hamiltonian ( 2.2). Assume that (A0)-(A1)hold andζ0=0is a equilibrium point of g(z), i.e., g(z)=o(|z|2),∇g(ζ0)=0. (2.3) 4Letε0>0be suﬃciently small. Then as 0<ε<ε 0, there exist Cantor sets G ∗⊂G with|G\G∗|→0asε→0as well as a Cm−1Whitney smooth family of symplectic transformations Ψ∗=Φ 1◦Φ2◦···◦Φ∞:D(s 2,r 2)→D(s,r), ξ∈G∗, which is analytic in x, Cm−1Whitney smooth in y, z and ξ, and close to the identity, such that H∗=H◦Ψ∗=e∗(ξ)+/a\}b∇acketle{tω∗(ξ),y/a\}b∇acket∇i}ht+˜h∗(y,ξ)+g∗(z,ξ)+¯g∗(y,z,ξ)+P∗(x,y,z,ξ) (2.4) with ˜h∗(y,ξ)=O(|y|2), g∗(z,ξ)=g(z)+ε(m−2)(5m+4) 8m(m+1)O(|z|2), ¯g∗(y,z,ξ)=/summationdisplay 2|ı|+||≤m,1≤|ı|,||¯gı(ξ)yız, ∂i y∂j zP∗|(y,z)=(0,0)=0, where e∗,ω∗,˜h∗,g∗,¯g∗,P∗are real analytic in their associated variables, 2|i|+|j|≤m, and m≥L+√ L2+16L+16 4. (2.5) Thus for each 0<ε<ε 0the Hamiltonian system ( 2.2) admits a Whitney smooth family of real analytic, quasi-per iodic n-toriTε ξ,ξ∈G∗. Remark 2.1. In Theorem 1, one can allow d>1. Hence it seems to be the ﬁrst result about lower-dimensiona l invariant tori in the normal degeneracy of high co-dimensio n. Remark 2.2. Recall z=(u,v)∈Rd×Rd. For partially degenerate Hamiltonian ( 1.2) with g(u,v)=1 2d/summationdisplay i=1λiv2 i+f(u), λ i/nequal0,i=1,···,d,d≥1,f(u)=O(|u|4), we will study it in a forthcoming paper. Remark 2.3. (2.4) in Theorem 1indicates that the Hamiltonian system ( 2.2) is conjugated to a nonlinear system, not a linear one. Moreover, in order to ensure the persistenc e of low-dimensional invariant tori, the conjugated system cannot have ﬁrst order terms about z, i.e., g ∗(z)=O(|z|2), otherwise there is no invariant torus because one cannot get invariant set in the z direction as ∇g∗(0)/nequal0. Indeed, as an application of Theorem 1, we have the following proposition: Proposition 1. Consider the Hamiltonian ( 2.2) with g(u,v)=1 2l0|u|2l0+1 2k0|v|2k0, where l 0,k0>1are integers, the dimension of u might be any positive intege r, hence high co-dimensional. Assume ω(ξ)satisﬁes the condition (A1). Then the perturbed Hamiltonian system ( 1.2) admits a family of lower-dimensional tori. See Appendix A for the complete proof. Next, we will give an example to state that our assumption (A0) is sharp to Melnikov’s persistence. See below for a counter example: 5Proposition 2. Consider the Hamiltonian ( 1.2) with H=ω·y+1 3u3+1 3v3+ε2u, (2.6) where y∈R1,(u,v)∈R1×R1, andε2u is a perturbation term. Assume ωsatisﬁes Diophantine condition ( 1.1). Then the Hamiltonian system does not admit any lower-dimensiona l torus. The proof can be found in Appendix B. 3. KAM Step In this section, we will show the detailed construction and e stimates for one cycle of KAM steps, see [ 7,18,25, 26,33]. 3.1. Description of the 0-th KAM step. Recall the integer msatisfying m≥L+√ L2+16L+16 4, (3.7) where L≥2 is deﬁned as in (A0) . Denoteρ=1 2(m+1), and letη>0 be an integer such that (1 +ρ)η>2. We put γ=ε1 2m(m+1)(2d)m. (3.8) Consider the perturbed Hamiltonian ( 2.2). First we deﬁne the following 0-th KAM step parameters: r0=r, γ 0=γ, µ 0=ε1 8(m+1),s0=sε1 8(m+1)γ(m+1)(2d)m 0, σ 0=σ, β 0=s, e0=e(ξ), ω 0=ω(ξ),˜h0(y)=˜h(y),g0(z)=g(z),¯g0=0,G0=ˆG, (3.9) D(s0,r0) :={(x,y,z,ξ) :|y|<s2 0,|z|<s0,|Imx|<r0}, where 0<r0,s0,s,γ0≤1,σis deﬁned in (A0) . Therefore, we have that H0=:H(x,y,z,ξ)=N0+P0, N0=:e0+/a\}b∇acketle{tω0,y/a\}b∇acket∇i}ht+˜h0(y)+g0(z)+¯g0, P0=:εP(x,y,z,ξ). We ﬁrst prove an estimate. Lemma 3.1. Assume that (H0) :εm 8(m+1) 0|∂ℓ ξP|D(s0,r0) sm≤1,|ℓ|≤m. For|ℓ|≤m, |∂ℓ ξP0|D(s0,r0)≤γ(m+1)(2d)m 0sm 0µ0. (3.10) Proof. Using the factγ0=ε1 2m(m+1)(2d)m,s0=sε1 8(m+1)γ(m+1)(2d)m 0andµ0=ε1 8(m+1), we have sm 0=smεm 8(m+1)γm(m+1)(2d)m 0=smεm 8(m+1)+1 2, and γ(m+1)(2d)m 0sm 0µ0=ε1 2msmεm 8(m+1)+1 2ε1 8(m+1)≥smε1 4+5 8+1 8(m+1). (3.11) 6Then, by (H0) , for any 0<ε<ε 0, we get εm 8(m+1)|∂ℓ ξP|D(s0,r0) sm≤1,|ℓ|≤m, i.e., εm 8(m+1)|∂ℓ ξP|D(s0,r0)≤sm,|ℓ|≤m. (3.12) Thus, by ( 3.11) and ( 3.12), for|ℓ|≤m, |∂ℓ ξP0|D(s0,r0)=ε|∂ℓ ξP|D(s0,r0)≤ε1 4+5 8+1 8(m+1)εm 8(m+1)|∂ℓ ξP|D(s0,r0) ≤smε1 4+5 8+1 8(m+1)≤γ(m+1)(2d)m 0sm 0µ0, which implies ( 3.10). The proof is complete. 3.2. Induction from ν-th KAM step 3.2.1. Description of the ν-th KAM step We ﬁrst deﬁne the ν-th KAM step parameters: rν=rν−1 2+r0 4,sν=1 8s2ρ+1 ν−1, µν=8msρ ν−1µν−1. Now, suppose that at ν-th step, we have arrived at the following real analytic Hami ltonian: Hν=Nν+Pν, (3.13) with Nν=eν(ξ)+/a\}b∇acketle{tων(ξ),y/a\}b∇acket∇i}ht+˜hν(y,ξ)+gν(z,ξ)+¯gν(y,z,ξ), (3.14) ˜hν(y,ξ)=/summationdisplay 2≤|i|˜hi0(ξ)yi, gν(z,ξ)=g(z)+ν−1/summationdisplay i=0γ(m+1)(2d)m ism−2 iµiO(|z|2), ¯gν(y,z,ξ)=/summationdisplay 2|i|+|j|≤m,1≤|i|,|j|¯gi j(ξ)yizj, (3.15) deﬁned on D(sν,rν), ∇gν(0)=∇gν−1(ζν−ζν−1)+∇z[Rν−1](0,ζν−ζν−1)=0, ζν∈B(sm−2 ν−1µν−2)1 L(ζν−1), and |∂ℓ ξPν|D(sν,rν)≤γ(m+1)(2d)m ν sm νµν. (3.16) For simplicity, we will omit the index for all quantities of the present KAM st ep (atν-th step), use+to index all quantities (Hamiltonian, domains, normal form, pertur bation, transformation, etc.) in the next KAM step (at (ν+1)-th step), and use −to index all quantities in the previous KAM step (at ( ν-1)-th step). To simplify notations, we will not specify the dependence of P,P+etc. All the constants c1−c6(they will be deﬁned in di ﬀerent lemmas-Lemma 3.2,3.3,3.5,3.6,3.8,3.9) are positive and independent of the iteration process, and we will also use cto denote any intermediate positive constant which is indep endent of the iteration process. Deﬁne r+=r 2+r0 4, 7β+=β 2+β0 4, σ+=σ 2+σ0 4, γ+=γ 2+γ0 4, s+=1 8αs, α=s2ρ=s1 (m+1), µ+=8mc0µsρ,c0=max{1,c1,c2,···,c6}, K+=([log1 s]+1)3η,(1+ρ)η>2, D(s)={(y,z)∈Cn×R2d:|y|<s2,|z|<s}, ˆD(s)=D(s,r++7 8(r−r+)), ˜D=D(β+,r++5 8(r−r+)), Di 8α=D(i 8αs,r++i−1 8(r−r+)),i=1,2,···,8, D+=D1 8α=D(s+,r+), Γ(r−r+)=/summationdisplay 0<|k|≤K+|k|(m+1)(2d)mτ+me−|k|r−r+ 8, G+={ξ∈G:|/a\}b∇acketle{tk,ω/a\}b∇acket∇i}ht|>γ |k|τ,A⊤ıAı>γ2 |k|2τI(2d)ı+,f or k∈Zn, 0<|k|<K+,2|ı|+||≤m,1≤||} 3.2.2. Construct a symplectic transformation We will construct a symplectic transformation Φ+: Φ+:D(s+,r+)×G+→D(s,r)×G such that it transforms Hamiltonian ( 3.13) into the Hamiltonian of the next KAM cycle (at ( ν+1)-th step), i.e., H+=H◦Φ+=N++P+, where N+andP+have similar properties as NandPrespectively on D(sν+1,rν+1). Next, we show the detailed construction of Φ+and the estimates of P+. 3.2.3. Truncation Consider the Taylor-Fourier series of P: P=/summationdisplay k∈Zn,ı,∈Zn +pkıyıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht, and let Rbe the truncation of Pof the form R=/summationdisplay |k|≤K+,2|ı|+||≤mpkıyıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht =/summationdisplay |k|≤K+,2|ı|+||≤mpkıyı1 1···yınnz1 1···z2d 2de√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht, where|ı|=|ı1|+···+|ın|,||=|1|+···+|2d|. Next, we will prove that |P−R|is much smaller than |P|by truncating appropriately, see the below lemma. 8Lemma 3.2. Assume that (H1) :/integraldisplay∞ K+tne−tr−r+ 16dt≤s. Then there is a constant c 1such that for allξ∈G,|ℓ|≤m, |∂ℓ ξ(P−R)|Dα≤c1γ(m+1)(2d)msm+1µ, (3.17) |∂ℓ ξR|Dα≤c1γ(m+1)(2d)msmµ. (3.18) Proof. Denote I=/summationdisplay |k|>K+,ı,∈Zn +pkıyıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht, II=/summationdisplay |k|≤K+,2|ı|+||>mpkıyıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht. Then P−R=I+II. To estimate I, we notice by ( 3.16) that |/summationdisplay ı∈Zn +∂ℓ ξpkıyı|≤|∂ℓ ξP|D(s,r)e−|k|r≤γ(m+1)(2d)msmµe−|k|r, where the ﬁrst inequality has been frequently used in [ 7,8,18,25,33,34,37] and for the detailed proof, see [ 37]. This together with (H1) and ( 3.16) yields |∂ℓ ξI|ˆD(s)≤/summationdisplay |k|>K+|∂ℓ ξP|D(s,r)e−|k|r−r+ 8≤γ(m+1)(2d)msmµ∞/summationdisplay κ=K+κne−κr−r+ 8 ≤γ(m+1)(2d)msmµ/integraldisplay∞ K+tne−tr−r+ 16dt≤γ(m+1)(2d)msm+1µ. (3.19) It follows from ( 3.16) and ( 3.19) that |∂ℓ ξ(P−I)|ˆD(s)≤|∂ℓ ξP|D(s,r)+|∂ℓ ξI|ˆD(s)≤2γ(m+1)(2d)msmµ. For 2|p|+|q|=m+1, let/integraltext be the obvious antiderivative of∂(p,q) ∂ypzq. Then the Cauchy estimate of P−IonD∗yields |∂ℓ ξII|Dα=|∂ℓ ξ/integraldisplay∂(p,q) ∂ypzq/summationdisplay |k|≤K+,2|ı|+||>mpkıyıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}htdydz|Dα ≤|/integraldisplay |∂(p,q) ∂ypzq∂ℓ ξ(P−I)|dydz|Dα ≤|c sm+1/integraldisplay |∂ℓ ξ(P−I)|D∗dydz|Dα ≤2c sm+1γ(m+1)(2d)msmµ(αs)m+1 ≤cγ(m+1)(2d)msm+1µ. Thus, |∂ℓ ξ(P−R)|Dα≤cγ(m+1)(2d)msm+1µ, and therefore, |∂ℓ ξR|Dα≤|∂ℓ ξ(P−R)|Dα+|∂ℓ ξP|D(s,r)≤cγ(m+1)(2d)msmµ. The proof is complete. 93.2.4. Homological Equation As usual, we shall construct a symplectic transformation as the time 1-mapφ1 Fof the ﬂow generated by a Hamiltonian Fof the form F=/summationdisplay 0<|k|≤K+,2|ı|+||≤mFkıyıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht =/summationdisplay 0<|k|≤K+,2|ı|+||≤mFkıyı1 1···yınnz1 1···z2d 2de√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht, (3.20) where Fkıare (ξ,y,z)-dependent vectors or matrices of obvious dimensions. The Hamiltonian Fcan be determined by the following quasi-linear homologica l equation {N,F}+R−[R]−Q=0, (3.21) where [ R]=1 (2π)n/integraltext TnR(x,y,z)dxis the average of the truncation R, and the correction term Q=(∂zg+∂z¯g)J∂zF|2|ı|+||>m, (3.22) corresponds to the ( m+1)-order and higher-order terms in /a\}b∇acketle{t∇z¯g,˜J∇zF/a\}b∇acket∇i}ht. Recall ( 3.14), i.e., N=e(ξ)+/a\}b∇acketle{tω(ξ),y/a\}b∇acket∇i}ht+˜h(y,ξ)+g(z,ξ)+¯g(y,z,ξ), with ˜h(y,ξ)=/summationdisplay 2≤|i|˜h0i0(ξ)yi,g(z,ξ)=/summationdisplay 2≤|j|g00j(ξ)zj,¯g(y,z,ξ)=/summationdisplay 2|i|+|j|≤m,1≤|i|,|j|¯g0i j(ξ)yizj. Notice that {N,F}=−∂yN∂xF+∂xN∂yF+∂zNJ∂zF =−√ −1/a\}b∇acketle{tk,ω+∇˜h(y)+∂y¯g/a\}b∇acket∇i}htFkıyıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht+(∂zg+∂z¯g)J∂zF. (3.23) In order to simplify the notations, we sometimes omit the sub script of/summationtextand only use/summationtextto represent the sum to the index over the corresponding range of variation. Now we calculate the last term of ( 3.23): (∂zg+∂z¯g)J∂zF=(∂zg+∂z¯g)J∂zF|2|ı|+||≤m+Q. (3.24) Specially, ∂zgJ∂zF|2|ı|+||≤m=∂zgJ/summationdisplay 0<|k|≤K+,2|ı|+||≤mFkıyı∂z(z)e√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht +∂zgJ/summationdisplay 0<|k|≤K+,2|ı|+||≤m∂z(Fkı)yıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht =:/summationdisplay SıFkıyıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht+/summationdisplay 2≤|j′|Sj′∂zFkı(−j′+1)yıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht =:/summationdisplay ˜SıFkıyıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht+/summationdisplay (Sı−˜Sı)Fkıyıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht(3.25) +/summationdisplay 2≤|j′|Sj′∂zFkı(−j′+1)yıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht, 10where 0<|k|≤K+, 2|ı|+||≤m, 2≤|j′|,Sıis a (|ı|+||) order tensor and concerned with ∂2 zg(z) and J,Sj′is concerned with∂j′ zg(0) and J,˜Sıis a (|ı|+||) order tensor and concerned with ∂2 zg(0) and J. And ∂z¯gJ∂zF|2|ı|+||≤m=∂z¯gJ/summationdisplay 0<|k|≤K+,2|ı|+||≤mFkıyı∂z(z)e√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht +∂z¯gJ/summationdisplay 0<|k|≤K+,2|ı|+||≤m∂z(Fkı)yıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht =:/summationdisplay Si j(Fk(ı−i)(+2−j)+∂zFk(ı−i)(+1−j))yıze√ −1/a\}b∇acketle{tk,x/a\}b∇acket∇i}ht(3.26) where Si jis concerned with∂i y∂j z¯g(0,0) and J, and 2|i|+|j|≤m, 1≤|i|, 1≤|j|, 0<|k|≤K+,2|ı|+||≤m. Substituting ( 3.24), (3.25), and ( 3.26) into ( 3.23), putting ( 3.22) and ( 3.23) into ( 3.21), comparing the coe ﬃcients, we thus obtain the following quasi-linear equations for all 0<|k|≤K+, 2|ı|+||≤m: (√ −1/a\}b∇acketle{tk,ω+∇˜h(y)+∇y¯g/a\}b∇acket∇i}htI(2d)ı+−Sı)Fkı=pkı+Sj′∂zFkı(−j′+1) (3.27) +Si jFk(ı−i)(+2−j)+Si j∂zFk(ı−i)(+1−j), where i,j,j′are deﬁned as above, Si jFk(ı−i)(+2−j)stands for/summationtext 2|i|+|j|≤m,1≤|i|,|j|Si jFk(ı−i)(+2−j), and the rest terms are analogously deﬁned. The above equations ( 3.27) are solvable if the coe ﬃcient matrices are nonsingular. We denote G+={ξ∈G:|/a\}b∇acketle{tk,ω/a\}b∇acket∇i}ht|>γ |k|τ,A⊤ıAı>γ2 |k|2τI(2d)ı+,f or k∈Zn, (3.28) 0<|k|<K+,2|ı|+||≤m,1≤||}, with Aı=√ −1/a\}b∇acketle{tk |k|,ω/a\}b∇acket∇i}htI(2d)ı++˜Sı |k|, (3.29) where ˜Sıis concerned with∂2g(0) ∂z2andJ. Then, we can solve equations ( 3.27) onG+. The details can be seen in the following lemma: Lemma 3.3. Assume that (H2) : max |ℓ|≤m,|i|≤m|∂ℓ ξ∂i y˜h−∂ℓ ξ∂i y˜h0|D(s)×G+≤s1 2 0, (H3) : 4s<γ−γ+ (M∗+2)Kτ+1 +, where M∗=max |ℓ|≤m,|i|≤m|∂ℓ ξ∂i y˜h0(y)|D(s)×G+. The quasi-linear equations ( 3.27) can be uniquely solved on D (s)×G+to obtain the coeﬃcient F kıwhich satisfy the following equality: |∂ℓ ξ∂i y∂j zFkı|D(s)×G+≤c2|k||ℓ|+|i|+|j|+(|ℓ|+|i|+|j|+1)(2d)τsm−2|ı|−||µe−|k|r, for all 0<|k|≤K+,2|ı|+||≤m,|ℓ|+|i|+|j|≤m, where c 2is a constant. Proof. For∀(y,ξ)∈D(s)×G+, by(H2),(H3) , |∇˜h|=|(∇˜h−∇˜h0)+∇˜h0|≤(1+M∗)|y|<(1+M∗)s<γ 4|k|τ+1. (3.30) 11Recalling that ¯ g(y,z) comes from the perturbation and it is formulized in ( 3.15), we have |∇y¯g|≤cs<γ 4|k|τ+1, (3.31) with c≤/summationtextν−1 i=0γ(m+1)(2d)m ism−3 iµi≪1, where the last equality follows from (H3) . Notice by ( 3.30) and ( 3.31) that |det/a\}b∇acketle{tk,∇˜h+∇y¯g/a\}b∇acket∇i}htI(2d)ı+|≤(γ 4|k|τ)(2d)ı+,2|ı|+||≤m. It follows from the deﬁnition of Sı,˜Sıandgthat |det(Sı−˜Sı)|≤|det(|s|I(2d)ı+)|<(γ 4|k|τ)(2d)ı+,2|ı|+||≤m. This together with ( 3.27) and ( 3.28) yields |detBı|>γ(2d)ı+ 2(|k|τ)(2d)ı+,2|ı|+||≤m (3.32) where Bıis the coeﬃcient matrix of ( 3.27). Then, by ( 3.32), |Bı|−1=|adjBı detBı|≤c|k|τ(2d)+(2d)−1 γ(2d),2|ı|+||≤m where adj Bıis the algebraic minor of Bı. Applying the identity ∂j zB−1 ı=−|j|/summationdisplay |j′|=1/parenleftiggj j′/parenrightigg (∂j−j′ zB−1 ı∂j′ zBı)B−1 ı inductively, we have for |ℓ|+|i|+|j|≤m |∂ℓ ξ∂i y∂j zB−1 ı|D(s)×G+≤c|k||ℓ|+|i|+|j||B−1 ı||ℓ|+|i|+|j|+1 ≤c|k||ℓ|+|i|+|j|+(|ℓ|+|i|+|j|+1)(2d)τ γ(|ℓ|+|i|+|j|+1)(2d),2|ı|+||≤m, which was precisely proved in [ 24,25]. We note by the Cauchy estimate that for 2 |ı|+||≤m, |∂ℓ ξpkı|G+≤|∂ℓ ξP|D(s)×G+s−2|ı|−||e−|k|r≤γ(m+1)(2d)msm−2|ı|−||µe−|k|r. So, for|ℓ|+|i|+|j|≤m, 2|ı|+||≤m, |∂ℓ ξ∂i y∂j zFkı|D(s)×G+≤c|k||ℓ|+|i|+|j|+(|ℓ|+|i|+|j|+1)(2d)τ γ(|ℓ|+|i|+|j|+1)(2d)γ(m+1)(2d)msm−2|ı|−||µe−|k|r ≤c|k||ℓ|+|i|+|j|+(|ℓ|+|i|+|j|+1)(2d)τsm−2|ı|−||µe−|k|r. The proof is complete. Next, we apply the above transformation φ1 Fto Hamiltonian H, i.e., H◦φ1 F=(N+R)◦φ1 F+(P−R)◦φ1 F =(N+R)+{N,F}+/integraldisplay1 0{(1−t){N,F}+R,F}◦φt Fdt+(P−R)◦φ1 F =N+[R]+/integraldisplay1 0{Rt,F}◦φt Fdt+(P−R)◦φ1 F+Q 12=:¯N++¯P+, where ¯N+=N+[R], ¯P+=/integraldisplay1 0{Rt,F}◦φt Fdt+(P−R)◦φ1 F+Q, (3.33) Rt=(1−t)Q+(1−t)[R]+tR. 3.2.5. Translation In this subsection, we will construct a translation so as to e liminate the ﬁrst order terms about z. Consider the translation φ:x→x,y→y,z→z+ζ+−ζ, where z=(u,v),ζ+is to be determined. Let Φ+=φ1 F◦φ. Then H◦Φ+=N++P+, N+=¯N+◦φ, P+=¯P+◦φ, (3.34) with N+=¯N+◦φ=(N+[R])◦φ=(e+/a\}b∇acketle{tω,y/a\}b∇acket∇i}ht+˜h(y)+g(z)+¯g(y,z)+[R](y,z))◦φ =e+/a\}b∇acketle{tω,y/a\}b∇acket∇i}ht+˜h(y)+g(z+ζ+−ζ)+¯g(y,z+ζ+−ζ)+[R](y,z+ζ+−ζ) =:e++/a\}b∇acketle{tω+,y/a\}b∇acket∇i}ht+˜h++g++¯g+, where e+=e+g(ζ+−ζ)+[R](0,ζ+−ζ), (3.35) ω+=ω+∇y[R](0,ζ+−ζ)+∇y¯g(0,ζ+−ζ), (3.36) ˜h+=˜h(y)+[R](y,ζ+−ζ)−[R](0,ζ+−ζ)−/a\}b∇acketle{t∇ y[R](0,ζ+−ζ),y/a\}b∇acket∇i}ht (3.37) +¯g(y,ζ+−ζ)−/a\}b∇acketle{t∇ y¯g(0,ζ+−ζ),y/a\}b∇acket∇i}ht, g+=g(z+ζ+−ζ)−g(ζ+−ζ)+[R](0,z+ζ+−ζ)−[R](0,ζ+−ζ), (3.38) ¯g+=¯g(y,z+ζ+−ζ)−¯g(y,ζ+−ζ)+[R](y,z+ζ+−ζ)−[R](y,ζ+−ζ) (3.39) −[R](0,z+ζ+−ζ)+[R](0,ζ+−ζ). 3.2.6. Eliminate the ﬁrst order terms about z In this subsection, we will appropriately choose ζ+to remove the ﬁrst order terms about z. The concrete details are expressed as the following lemma, which is crucial to our proof. Lemma 3.4. Notice that ∇g+(0)=∇g(ζ+−ζ)+∇z[R](0,ζ+−ζ). (3.40) There existsζ+∈B(sm−1 −µ−)1 L(ζ)such that ∇g+(0)=∇g(0)=···=∇g0(0)=0. 13Proof. The proof will be completed by induction on ν. We start with the case ν=0. It follows from ( 2.3) and (A0) that ∇g0(ζ0)=∇g0(0)=0, deg(∇g0(·)−∇g0(0),Oo,0)/nequal0, |∇g0(z)−∇g0(z∗)|≥σ0|z−z∗|L. Now assume that for some ν≥1 we have got ∇gi(0)=∇gi−1(ζi−ζi−1)+∇z[Ri−1](0,ζi−ζi−1)=0, deg(∇gi(·)−∇gi(0),Oo,0)/nequal0, (3.41) |∇gi(z)−∇gi(z∗)|≥σi|z−z∗|L, (3.42) where i=1,2,···,ν,ζ i∈B(sm−1 i−2µi−2)1 L(ζi−1),s−1=s0,µ−1=µ0,z∗∈O,z∈O\B(sm−1 i−1µi−1)1 L(z∗).Then, we need to ﬁnd ζ+ nearζsuch that∇g+(0)=∇g(0). Consider homotopy Ht(z) : [0,1]×O→R2d, Ht(z)=:∇g(z−ζ)−∇g(0)+t∇z[R](0,z−ζ). Notice that |∇z[R](y,z)|≤γ(m+1)(2d)msm−1µ. (3.43) For any z∈∂O,t∈[0,1], by ( 3.42) and ( 3.43), we have |Ht(z)|≥|∇ g(z−ζ)−∇g(0)|−|∇ z[R](0,z−ζ)| ≥σ|z−ζ|L−γ(m+1)(2d)msm−1µ >σδL 2, whereδ:=min{|z−ζ|,∀z∈∂O}. So, it follows from the homotopy invariance and ( 3.41) that deg(H1(·),Oo,0)=deg(H0(·),Oo,0)/nequal0. (3.44) We note by ( 3.42) and ( 3.43) that for any z∈O\B(sm−1 −µ−)1 L(ζ), |H1(z)|=|∇g(z−ζ)−∇g(0)+∇z[R](0,z−ζ)| ≥|∇g(z−ζ)−∇g(0)|−|∇ z[R](0,z−ζ)| ≥σ|z−ζ|L−γ(m+1)(2d)msm−1µ ≥σsm−1 −µ−−γ(m+1)(2d)msm−1µ ≥σ 2sm−1 −µ−. Hence, by excision and ( 3.44), deg(H1(·),B(sm−1 −µ−)1 L(ζ),0)=deg(H1(·),Oo,0)/nequal0, then there exist at least a ζ+∈B(sm−1 −µ−)1 L(ζ), such that H1(ζ+)=0, i.e., ∇g(ζ+−ζ)+∇z[R](0,ζ+−ζ)=∇g(0), 14thus, by ( 3.40), ∇g+(0)=∇g(0)=···=∇g0(0)=0. (3.45) Next, we need to prove deg(∇g+(·)−∇g+(0),Oo,0)/nequal0, (3.46) |∇g+(z)−∇g+(z∗)|≥σ+|z−z∗|L. (3.47) By (3.38), ∇g+(z)=∇g(z+ζ+−ζ)+∇z[R](0,z+ζ+−ζ). Then ∇g+(z)−∇g(z)=∇g(z+ζ+−ζ)−∇g(z)+∇z[R](0,z+ζ+−ζ), (3.48) and ∇g+(z)−∇g+(z∗)=∇g(z+ζ+−ζ)−∇g(z∗+ζ+−ζ) (3.49) +∇z[R](0,z+ζ+−ζ)−∇ z[R](0,z∗+ζ+−ζ). In view of ( 3.43), (3.48), andζ+∈B(sm−1 −µ−)1 L(ζ), we get |∇g+(z)−∇g(z)|≤c(sm−1 −µ−)1 L, so, this together with the property of degree, ( 3.41) and ( 3.45) that ( 3.46) holds, i.e., deg(∇g+(·)−∇g+(0),Oo,0)=deg(∇g+(·)−∇g(·)+∇g(·)−∇g(0),Oo,0) =deg(∇g(·)−∇g(0),Oo,0)/nequal0. It follows from ( 3.42), (3.43) and ( 3.49) that for any z∈O\B(sm−1µ)1 L(z∗) |∇g+(z)−∇g+(z∗)|≥σ|z−z∗|L−2γ(m+1)(2d)msm−1µ≥σ+|z−z∗|L, which implies ( 3.47). The proof is complete. 3.2.7. Estimate on N + Now, we give the estimate of N+. Lemma 3.5. There is a constant c 3such that for all|ℓ|≤m: |∂ℓ ξ(ζ+−ζ)|G+≤c3(sm−1 −µ−)1 L, (3.50) |∂ℓ ξ(e+−e)|G+≤c3(sm−1 −µ−)1 L, (3.51) |∂ℓ ξ(ω+−ω)|G+≤c3(sm−1 −µ−)1 L, (3.52) |∂ℓ ξ(˜h+−˜h)|D(s+)×G+≤c3(sm−1 −µ−)1 L, (3.53) |∂ℓ ξ(g+−g)|D(s+)×G+≤c3(sm−1 −µ−)1 L, (3.54) |∂ℓ ξ(¯g+−¯g)|D(s+)×G+≤c3(sm−1 −µ−)1 L. (3.55) 15Proof. Diﬀerentiating ( 3.40) with respect toξyields (∇2g(ζ+−ζ)+∇2 z[R](0,ζ+−ζ))∂ξ(ζ+−ζ)=∂ξ∇g(ζ+−ζ)+∂ξ∇z[R](0,ζ+−ζ). Applying this identity inductively and using ζ+∈B(sm−1 −µ−)1 L(ζ) in Lemma 3.4, we can immediately get ( 3.50). Recall e+andω+in (3.35) and ( 3.36), respectively, we see that |∂ℓ ξ(e+−e)|G+≤c|∂ℓ ξ(ζ+−ζ)|2+γ(m+1)(2d)msmµ≤c(sm−1 −µ−)1 L, |∂ℓ ξ(ω+−ω)|G+≤c|∂ℓ ξ(ζ+−ζ)|+γ(m+1)(2d)msm−2µ≤c(sm−1 −µ−)1 L, which implies ( 3.51) and ( 3.52). In view of ( 3.37), we have that |∂ℓ ξ(˜h+(y)−˜h(y))|D(s+)=|∂ℓ ξ([R](y,ζ+−ζ)−[R](0,ζ+−ζ)−/a\}b∇acketle{t∇ y[R](0,ζ+−ζ),y/a\}b∇acket∇i}ht)| +|∂ℓ ξ(¯g(yı(ζ+−ζ))−/a\}b∇acketle{t∇ y¯g((ζ+−ζ)),y/a\}b∇acket∇i}ht)| ≤γ(m+1)(2d)msmµ+(sm−1 −µ−)1 Ls4 + ≤c(sm−1 −µ−)1 L. It follows from ( 3.38) that |∂ℓ ξ(g+(z)−g(z))|D(s+)=|∂ℓ ξ(g(z+ζ+−ζ)−g(ζ+−ζ)−g(z))| +|∂ℓ ξ([R](0,z+ζ+−ζ)−[R](0,ζ+−ζ))| ≤c(sm−1 −µ−)1 Ls2 ++γ(m+1)(2d)msmµ ≤c(sm−1 −µ−)1 L. According to ( 3.39), we obtain that |∂ℓ ξ(¯g+(yız)−¯g(yız))|D(s+)≤|∂ℓ ξ[R](yız)|≤c4γ(m+1)(2d)msmµ≤c(sm−1 −µ−)1 L. 3.2.8. Estimate on Φ+ Recall that Fis as in ( 3.20) with the coeﬃcients and its estimate is given by Lemma 3.3. Then, we have the following estimate on F. Lemma 3.6. There is a constant c 4such that for all|ℓ|+|l|+|i|+|j|≤m, |∂ℓ ξ∂l x∂i y∂j zF|ˆD(s)×G+≤/braceleftiggc4sm−2|i|−|j|µΓ(r−r+), 2|i|+|j|≤m, c4µΓ(r−r+), m≤2|i|+|j|.(3.56) Proof. Let a(i,j)=/braceleftiggsm−2|i|−|j|,i f2|i|+|j|≤m, 0, otherwise. By (3.20) and Lemma 3.3, we have |∂ℓ ξ∂l x∂i y∂j zF|ˆD(s)×G+≤/summationdisplay 0<|k|≤K+,2|ı|+||≤m|k|l|∂ℓ ξ∂i y∂j z(Fkıyız)|e|k|(r++7 8(r−r+)) ≤/summationdisplay 0<|k|≤K+c|k||l|+|ℓ|+|i|+|j|+(|ℓ|+|i|+|j|+1)(2d)τsa(i,j)µe−|k|r−r+ 8 ≤csa(i,j)µΓ(r−r+). This proves ( 3.56). The proof is complete. 16To obtain the symplectic transformation stated in Theorem 1, we need to extend the function Fsmoothly to the domain ˆD(β0)×G0. Lemma 3.7. Assume (H2) -(H3) . Then F andζ+−ζcan be smoothly extended to functions of H¨ older class Cm−1+̺,m−1+̺(ˆD(β0)×G0)and Cm−1+̺respectively, where 0<̺< 1is ﬁxed. Moreover, there is a constant c such that /ba∇dblF/ba∇dblCm−1+̺,m−1+̺(ˆD(β0)×G0)≤cµΓ(r−r+), (3.57) /ba∇dblζ+−ζ/ba∇dblCm−1+̺(G0)≤c(sm−1 −µ−)1 L, (3.58) where/ba∇dblF/ba∇dblCm−1+̺,m−1+̺(ˆD(β0)×G0)=:|∂ℓ ξ∂l x∂i y∂j zF|ˆD(β0)×G0,|ℓ|≤m−1+̺,|l|+|i|+|j|≤m−1+̺. Proof. It follows from the standard Whitney extension theorem that Fandζ+−ζcan be extended smoothly to functions ˜Fand ˜(ζ+−ζ) of H¨ older class Cm−1+̺,m−1+̺(ˆD(β0×G0)),Cm−1+̺(G0), respectively, such that /ba∇dbl˜F/ba∇dblm−1+̺,m−1+̺ C(ˆD(β0×G0))≤c/ba∇dblF/ba∇dblCm,m(ˆD(s)×G+), /ba∇dbl˜ζ+−ζ/ba∇dblCm−1+̺(G0)≤c/ba∇dblζ+−ζ/ba∇dblCm(G+), where cis a constant depending only on m,̺and the dimensions n,d. The lemma now follows from ( 3.56) in Lemma 3.6and ( 3.50) in Lemma 3.5. Lemma 3.8. In addition to (H2) -(H3) , assume that (H4) :c3(sm−1 −µ−)1 L<1 8αs, (H5) :c4µΓ(r−r+)<1 4(r−r+), (H6) :c4sm−1µΓ(r−r+)<1 8αs, (H7) :c3µΓ(r−r+)+c3(sm−1µ)1 L<β−β+. Then the following hold: (1) For all 0≤t≤1, φt F:D1 4α→D1 2α, (3.59) φ:D1 8α→D1 4α, (3.60) are well deﬁned. (2) LetΦ+=φ1 F◦φ. Then for allξ∈G+, Φ+:D+→D, ˜D+→D(β,r).(3.61) (3) There is a constant c 5such that |∂ℓ ξDi (x,y,z)(φt F−id)|Dα 4×G+≤c5µΓ(r−r+),|ℓ|+|i|≤m, where Di (x,y,z)F stands for the|i|-order partial derivative with respect to (x,y,z). (4) |∂ℓ ξDi (x,y,z)(Φ+−id)|˜D×G+≤c5µΓ(r−r+),|ℓ|+|i|≤m. 17Proof. (1) For∀(x,y,z)∈D1 8α, we note byζ+∈B(sm−1 −µ−)1 L(ζ) and (H4) that |z+ζ+−ζ|<|z|+|ζ+−ζ|<1 8αs+c(sm−1 −µ−)1 L<1 4αs, which implies ( 3.60). To verify ( 3.59), we denoteφt F1,φt F2,φt F3as the components of φt Fin the x,y,zcoordinates, respectively. Let XF=(Fy,−Fx,˜JFz)⊤be the vector ﬁeld generated by F. Then φt F=id+/integraldisplayt 0XF◦φλ Fdλ, 0≤t≤1. (3.62) For any ( x,y,z)∈D1 4α, we let t∗=sup{t∈[0,1] :φt F(x,y,z)∈Dα}. Then for any 0≤t≤t∗, in view of ( x,y,z)∈D1 4α, (3.56) in Lemma 3.6,(H5) and(H6) |φt F1(x,y,z)|D1 4α≤|x|+/integraldisplayt 0|Fy◦φλ F|D1 4αdλ ≤r++1 8(r−r+)+c4sm−2µΓ(r−r+) <r++3 8(r−r+), |φt F2(x,y,z)|D1 4α≤|y|+/integraldisplayt 0|−Fx◦φλ F|D1 4αdλ ≤1 4αs+c4smµΓ(r−r+) <3 8αs, |φt F3(x,y,z)|D1 4α≤|z|+/integraldisplayt 0|˜JFz◦φλ F|D1 4αdλ ≤1 4αs+c4sm−1µΓ(r−r+) <3 8αs. Thus,φt F∈D1 2α⊂Dα, i.e. t∗=1 and (1) holds. (2) Using (H5) ,(H7) , (3.57) and a similar argument as above, one sees that φt F:¯D+→D(β,r) is well deﬁned for all 0≤t≤1, where ¯D+=D(r++5 8(r−r+),β++c(sm−1 −µ−)1 L). Thus,Φ+:˜D+→D(β,r) is also well deﬁned. (3) Note that |∂ℓ ξXF|˜D×G+≤c|∂ℓ ξD(x,y,x)F|˜D×G+. (3.63) Using ( 3.56) in Lemma 3.6and ( 3.62), we immediately have |φt F−id|Dα 4×G+≤cµΓ(r−r+). Diﬀerentiating ( 3.62) yields D(x,y,z)φt F=I2n+2d+/integraldisplayt 0(D(x,y,z)XF)D(x,y,z)φλ Fdλ =I2n+2d+/integraldisplayt 0J(D2 (x,y,z)F)D(x,y,z)φλ Fdλ, 0≤t≤1. 18It follows from Lemma 3.6, (3.62) and Gronwall Inequality that |D(x,y,z)φt F−I2n+2d|Dα 4×G+≤|/integraldisplayt 0D(x,y,z)XF◦φλ FD(x,y,z)φλ Fdλ|Dα 4×G+ ≤/integraldisplayt 0|D(x,y,z)XF◦φλ F||D(x,y,z)φλ F−I2n+2d|ˆD(s)×G+dλ +/integraldisplayt 0|D(x,y,z)XF◦φλ F|ˆD(s)×G+dλ ≤cµΓ(r−r+). Similarly, by using ( 3.56) in Lemma 3.6, Gronwall’s inequality and ( 3.63) inductively, we have |∂ℓ ξDi (x,y,z)φt F|Dα 4×G+≤cµΓ(r−r+),|ℓ|+|i|≤m. (4) Observe that Φ+−id=(φ1 F−id)◦φ+0 0 ζ+−ζ. Then, |∂ℓ ξDi (x,y,z)(Φ+−id)|˜D×G+≤|∂ℓ ξDi (x,y,z)(φ1 F−id)|˜D×G+|∂ℓ ξDi (x,y,z)φ|˜D×G+ +|∂ℓ ξ(ζ+−ζ)|˜D×G+ ≤cµΓ(r−r+)(sm−1 −µ−)1 L+(sm−1 −µ−)1 L ≤cµΓ(r−r+)αs+αs ≤cµΓ(r−r+), where the second equality follows from ( 3.57) and ( 3.58) in Lemma 3.7, the third equality follows from (H4) , and the last equality follows from the deﬁnition of µands. The proof is complete. 3.2.9. Frequency Property To estimate the new frequency, we ﬁrst assume that (H8) : 3sK2τ+1 +≤{γ−γ+ γ0,γ2−γ2 + γ2 0}. It is obvious that for all 0 <|k|≤K+,ξ∈G+, |/a\}b∇acketle{tk,∇y[R](0,ζ+−ζ)/a\}b∇acket∇i}ht|≤cK+γ(m+1)(2d)msm−2µ, |/a\}b∇acketle{tk,∇y¯g((ζ+−ζ))/a\}b∇acket∇i}ht|≤cK+γ(m+1)(2d)m(sm−1 −µ−)1 L≤cK+γ(m+1)(2d)mαs. Then this together with ( 3.36) and (H8) yields |/a\}b∇acketle{tk,ω+/a\}b∇acket∇i}ht|≥|/a\}b∇acketle{t k,ω/a\}b∇acket∇i}ht|−|/a\}b∇acketle{t k,∇y[R](0,ζ+−ζ)+∇y¯g((ζ+−ζ))/a\}b∇acket∇i}ht| ≥γ |k|τ−γ−γ+ |k|τ=γ+ |k|τ. Recall that A+ ı=√ −1/a\}b∇acketle{tk |k|,ω+/a\}b∇acket∇i}htI(2d)ı++˜S+ ı |k|=Aı+√ −1/a\}b∇acketle{tk |k|,ω+−ω/a\}b∇acket∇i}htI(2d)ı++˜S+ ı−˜Sı |k|=:Aı+˜Aı, 19where Aı=√ −1/a\}b∇acketle{tk |k|,ω/a\}b∇acket∇i}htI(2d)ı++˜Sı |k|, ˜Aı=√ −1/a\}b∇acketle{tk |k|,ω+−ω/a\}b∇acket∇i}htI(2d)ı++˜S+ ı−˜Sı |k|. Then, A+⊤ıA+ ı=A⊤ıAı+A⊤ı˜Aı+˜A⊤ıAı+˜A⊤ı˜Aı. (3.64) By (3.50) in Lemma ( 3.5) , we have |√ −1/a\}b∇acketle{tk |k|,ω+−ω/a\}b∇acket∇i}ht|≤(sm−1 −µ−)1 L≤cαs. (3.65) Note that ˜S+ ı−˜Sıis concerned with∂2 zg+(0)−∂2 zg(0), then, by ( 3.38), (3.18) in Lemma 3.2, |˜S+ ı−˜Sı| |k|≤cγ(m+1)(2d)ı+sm−2µ. (3.66) Thus, by ( 3.64), (3.65), (3.66) and (H8) , A+⊤ıA+ ı≥γ2 |k|2τI(2d)ı+−γ2−γ2 + 3|k|2τI(2d)ı+−γ2−γ2 + 3|k|2τI(2d)ı+−γ2−γ2 + 3|k|2τI(2d)ı+≥γ2 + |k|2τI(2d)ı+. 3.2.10. Estimate on P + In the following, we estimate the next step P+. Lemma 3.9. Denote ∆=αm+1sm+1µ(sm−2µΓ2(r−r+)+Γ(r−r+))+γ(m+1)(2d)ms2m−2µ2Γ(r−r+) +γ(m+1)(2d)msm+1µc. Assume (H0) -(H8) . Then there is a constant c 6such that for all|ℓ|≤m |∂ℓ ξ¯P+|D+×G+≤c6∆. (3.67) Moreover, if (H9) :c6∆≤γ(m+1)(2d)m + sm +µ+, then |∂ℓ ξP+|D+×G+≤γ(m+1)(2d)m + sm +µ+. (3.68) Proof. Recall the deﬁnition of Qas in ( 3.22). Observe by ( 3.39) and ( 3.56) that |∂ℓ ξQ|D1 4α×G+≤c(αs)m+1µΓ(r−r+) (3.69) and |∂ℓ ξ{Q,F}|D1 4α×G+≤cαm+1sm+1sm−2µ2Γ2(r−r+)+cαm+1sm−1smµ2Γ2(r−r+) +cαm+1smsm−1µ2Γ2(r−r+) ≤cαm+1s2m−1µ2Γ2(r−r+). (3.70) 20Using ( 3.18) in Lemma 3.2and ( 3.56) in Lemma 3.6, we also have |∂ℓ ξ[R]|ˆD×G++|∂ℓ ξR|ˆD×G+≤γ(m+1)(2d)msmµ, and |∂ℓ ξ{[R],F}|D1 4α×G++|∂ℓ ξ{R,F}|D1 4α×G+≤cγ(m+1)(2d)ms2m−2µ2Γ(r−r+). (3.71) Let us recall the deﬁnition of ¯P+in (3.33), that is ¯P+=/integraldisplay1 0{Rt,F}◦φt Fdt+(P−R)◦φ1 F+Q,Rt=(1−t)Q+(1−t)[R]+tR. Then by ( 3.17), (3.69), (3.70) and ( 3.71), |∂ℓ ξ¯P+|D1 4α×G+≤cαm+1s2m−1µ2Γ2(r−r+)+cγ(m+1)(2d)ms2m−2µ2Γ(r−r+) +cγ(m+1)(2d)msm+1µ+c(αs)m+1µΓ(r−r+) ≤αm+1sm+1µ(sm−2µΓ2(r−r+)+Γ(r−r+)) +γ(m+1)(2d)msm+1µ(sm−3µΓ(r−r+)+c), which implies ( 3.67). Moreover, by (H9) and the deﬁnition of P+as in ( 3.34), we see |∂ℓ ξP+|D+×G+≤γ(m+1)(2d)m + sm +µ+. The proof is complete. This completes one cycle of KAM steps. 4. Proof of Theorem 1 4.1. Iteration Lemma In this section, we will prove an iteration lemma which guara ntees the inductive construction of the transformations in all KAM steps. Letr0,s0,γ0,µ0,H0,N0,P0be given at the beginning of Section 3and let D0=D(s0,r0),˜D0=D(β0,r0),K0=0, Φ0=id. We deﬁne the following sequence inductively for all ν=1,2,···. rν=r0(1 2+1 2ν+1), βν=β0(1 2+1 2ν+1), γν=γ0(1 2+1 2ν+1), sν=1 8αν−1sν−1, αν=s2ρ ν=s1 m+1ν, µν=8mc0µν−1sρ ν−1, Kν=([log(1 sν−1)]+1)3η, Dν=D(sν,rν), ˜Dν=D(βν,rν+5 8(rν−1−rν)), 21D(sν)={(y,z) :|y|<s2 ν,|z|<sν}, Gν={ξ∈Gν−1:|/a\}b∇acketle{tk,ων−1/a\}b∇acket∇i}ht|>γ |k|τ,Aν−1⊤ıAν−1 ı>γ2 |k|2τI(2d)ı+,f or k∈Zn,0<|k|<Kν, 2|ı|+||≤m,1≤||},where Aν−1 ıis de f ined as in (3.29). Lemma 4.1. Denote µ∗=s2ε1 4(m+1)γ2(m+1)(2d)m 0. Ifεis small enough, then the KAM step described in Section 3is valid for allν=0,1,···, resulting in the sequences eν,ων,˜hν,gν,¯gν,Hν,Pν,Φν, ν=1,2,···,with the following properties: (1) For all|ℓ|≤m, |∂ℓ ξ(eν+1−eν)|D(sν+1)×Gν+1≤µ1 2∗ 2ν, (4.72) |∂ℓ ξ(eν−e0)|D(sν)×Gν≤2µ1 2∗, (4.73) |∂ℓ ξ(ων+1−ων)|D(sν+1)×Gν+1≤µ1 2∗ 2ν, (4.74) |∂ℓ ξ(ων−ω0)|D(sν)×Gν≤2µ1 2∗, (4.75) |∂ℓ ξ(˜hν+1−˜hν)|D(sν+1)×Gν+1≤µ1 2∗ 2ν, (4.76) |∂ℓ ξ(˜hν−˜h0)|D(sν)×Gν≤2µ1 2∗, (4.77) |∂ℓ ξ(gν+1−gν)|D(sν+1)×Gν+1≤µ1 2∗ 2ν, (4.78) |∂ℓ ξ(gν−g0)|D(sν)×Gν≤2µ1 2∗, (4.79) |∂ℓ ξ(¯gν+1−¯gν)|D(sν+1)×Gν+1≤µ1 2∗ 2ν, (4.80) |∂ℓ ξ(¯gν−¯g0)|D(sν)×Gν≤2µ1 2∗, (4.81) |∂ℓ ξ(ζν+1−ζν)|Gν+1≤(sm−1 ν−1µν−1)1 L, (4.82) |∂ℓ ξPν|Dν×Gν≤γ(m+1)(2d)m ν sm νµν. (4.83) (2) Gν+1={ξ∈Gν:|/a\}b∇acketle{tk,ων/a\}b∇acket∇i}ht|>γν |k|τ,Aν⊤ıAν ı>γ2 ν |k|2τI(2d)ı+,f or k∈Zn,Kν<|k|≤Kν+1,2|ı|+||≤m,1≤||}. (3) There exists a family of symplectic coordinate transfor mationsΦν+1:˜Dν+1×Gν+1→˜Dνand a subset G ν+1⊂Gν, Gν+1=Gν\/uniondisplay Kν<|k|≤Kν+1Rν+1 k(γν), (4.84) where Rν+1 k(γν)={ξ∈Gν:|/a\}b∇acketle{tk,ων/a\}b∇acket∇i}ht|≤γν |k|τ,Aν⊤ıAν ı≤γ2 ν |k|2τI(2d)ı+, f or k∈Zn,Kν<|k|≤Kν+1,2|ı|+||≤m,1≤||}, 22such that on ˜Dν+1×Gν+1 Hν+1=Hν◦Φν+1=Nν+1+Pν+1, and |∂ℓ ξ∂i (x,y,z)(Φν+1−id)|˜Dν+1×Gν+1≤µ1 2∗ 2ν. (4.85) Proof. The proof amounts to the veriﬁcation of (H0) -(H9) for allν. For simplicity, we let r0=1. We can make s0 small by pickingε0suﬃciently small. So, we see that (H0) holds and (H1) -(H9) hold forν=0. Note that µν=(8mc0)ν(1 8)(m+2)((1+1 m+1)ν−1)−(ν−1) 2 s1 2((1+1 m+1)ν−1) 0µ0, (4.86) sν=(1 8)(m+1)((1+1 m+1)ν−1)s(1+1 m+1)ν 0. (4.87) Letθ≫1 be ﬁxed and s0be small enough so that s0<(8 θ)1 2ρ<1. (4.88) Then s1=1 8s1+2ρ 0<1 θs0<1, s2=1 8s1+2ρ 1<1 θs1<1 θ2s0, ... sν=1 8s1+2ρ ν−1<···<1 θνs0. (4.89) Denote Γν=Γ(rν−rν+1). We notice thatrν−rν+1 r0=1 2ν+2. (4.90) Since Γν≤/integraldisplay∞ 1t(m+1)(2d)mτ+me−t 2ν+5dt ≤((m+1)(2d)mτ+m)!2(ν+5)((m+1)(2d)mτ+m), it is obvious that for θlarge enough, sρ 2νΓi ν<sρ 2ν(Γi ν+Γν)≤1,i=1,2, (4.91) and sνΓν≤s1−ρ ν≤s1−ρ 0 θ(1−ρ)ν. Recallαν=s1 m+1ν, thenαm+1 ν=sν. In view of s0=sε1 8(m+1)γ(m+1)(2d)m 0, we haveγ(m+1)(2d)m 0>s0. It is obvious by the deﬁnition ofγνand ( 4.87) thatγ(m+1)(2d)m ν>sνifε0is small enough. Moreover, γ(m+1)(2d)m ν s1 4(m+1) ν=(1 2+1 2ν+1)(m+1)(2d)m(1 8)1 4((1+1 m+1)ν−1)s1 4(m+1)(1+1 m+1)ν 0 23≤(1 2+1 2ν+2)(m+1)(2d)m=γ(m+1)(2d)m ν+1 ass0small enough. This together with the deﬁnition of ∆νas in Lemma 3.9yields ∆ν=αm+1 νsm+1 νµν(sm−2 νµνΓ2(rν−rν+1)+Γ(rν−rν+1)) +γ(m+1)(2d)m ν s2m−2 νµ2 νΓ(rν−rν+1)+γ(m+1)(2d)m ν sm+1 νµνc ≤γ(m+1)(2d)m ν s1 4(m+1) νs(1+1 m+1)m ν s1 2(m+1) νµν(s1 4(m+1) νsm−2 νµνΓ2(rν−rν+1) +s1 4(m+1) νΓ(rν−rν+1)+s1 4(m+1) νsm−3 νµΓ(rν−rν+1)+s1 4(m+1) νc) ≤γ(m+1)(2d)m ν+1sm ν+1µν+1, which implies that (H9) holds for allν≥1. We note that for any constant a>0,b>1,sa(log1 s+1)b→0 as s→0, then 3γ2 0sνKτ+1 ν+1≤3γ2 0sν([log1 sν]+1)3η(2τ+1) ≤(1 2+1 2ν+1)2−(1 2+1 2ν+2)2 =γ2 ν−γ2 ν+1, ifε0is small enough. Hence, (H8) holds. By (4.90) and ( 4.91), it is easy to verify that (H5) -(H7) hold for allν≥1 ifθis large enough and ε0is small enough. It is obvious by m≥L+√ L2+16L+16 4,L≥2 as in ( 3.7) that m−1 L>2m+2 m+1>(m+2 m+1)2, then sm−1 L −<s(m+2 m+1)2 −, i.e., (sm−1 −µ−)1 L<(1 8)1+m+2 m+1s(m+2 m+1)2 −=1 8sm+2 m+1=1 8αs, which implies (H4) . To verify (H3) , we observe by ( 4.87) and ( 4.89) that 4(M∗+2)sνKτ+1 ν+1<s0 2ν+2<γ0 2ν+2, asθis large enough, which veriﬁes (H3) for allν≥1. Letθ1−ρ≥2 in ( 4.88), (4.89). We have that for all ν≥1 sν≤s0 2ν≤µ1 2∗ 2ν. (4.92) The veriﬁcation of (H2) follows from ( 4.92) and an inductive application of ( 3.53) in Lemma 3.5for allν=0,1,···. Since (1+ρ)η>2, we have r0 2ν+6([log1 s]+1)η≥r0 2ν+6(−(1+ρ)νlogs0)η ≥−r0 2ν+6(1+ρ)ην(logµ0)η ≥1. 24It follows from the above that log(n+1)!+(ν+6)nlog 2+3nηlog([log1 s]+1)−r0 2(ν+6)([log1 s]+1)3η ≤log(n+1)!+(ν+6)nlog 2+3nηlog(log1 s+2)−(log1 s)2η ≤−log1 s, asµis small, which is ensured by making εsmall. Thus, /integraldisplay∞ Kν+1tne−tr0 2ν+6dt≤(n+1)!2(ν+6)nKn ν+1e−Kν+1 2ν+6≤s, i.e.(H1) holds. Above all, the KAM steps described in Section 3are valid for allν, which gives the desired sequences stated in the lemma. Now, ( 4.72), (4.74), (4.76), (4.78) and ( 4.80) follow from ( 3.53), (3.54) and ( 3.55) in Lemma 3.5and ( 4.92); by adding up ( 4.72), (3.52), (4.76), (4.78) and ( 4.80) for allν=0,1,···, we can get ( 4.73), (4.75) , (4.77), (4.79) and ( 4.81) respectively; ( 4.83) follows from ( 3.68) in Lemma 3.9; (4.82) follows from Lemma 3.5; (2) follows from Lemma 3.8. Note that (2) automatically holds for ν=0. We now letν>0. By Subsubsection 3.2.9 , it is obvious that Gν={ξ∈Gν:|/a\}b∇acketle{tk,ων/a\}b∇acket∇i}ht|>γν |k|τ,Aν⊤ıAν ı>γ2 ν |k|2τI(2d)ı+,f or k∈Zn,0<|k|≤Kν,2|ı|+||≤m,1≤||}. Denote ˆGν+1={ξ∈Gν:|/a\}b∇acketle{tk,ων/a\}b∇acket∇i}ht|>γν |k|τ,Aν⊤ıAν ı>γ2 ν |k|2τI(2d)ı+,f or k∈Zn,Kν<|k|≤Kν+1,2|ı|+||≤m,1≤||}. Then Gν+1={ξ∈Gν:|/a\}b∇acketle{tk,ων/a\}b∇acket∇i}ht|>γν |k|τ,Aν⊤ıAν ı>γ2 ν |k|2τI(2d)ı+,f or k∈Zn,0<|k|≤Kν+1,2|ı|+||≤m,1≤||} =Gν∩ˆGν+1=ˆGν+1, which implies ( 4.84). The proof is complete. 4.2. Convergence The convergence is standard. For the sake of completeness, w e brieﬂy give the outline of the proof. Let Ψν=Φ 0◦Φ2◦···◦Φν. Recalling thatΦν+1:˜Dν+1→˜Dνin Lemma 4.1, we have Ψν:˜Dν→˜D0, H0◦Ψν=Hν=Nν+Pν, ν=0,1,···,whereΨ0=id. Let G∗=/intersectiontext∞ ν=0Gν. First, we show the uniform convergence of ΨνonD(β0 2,r0 2)×G∗. Note that Ψν=id+ν/summationdisplay i=1(Ψi−Ψi−1), 25where, for each i=1,2,···, Ψi−Ψi−1=Φ 0◦···◦Φi−Φ0◦···◦Φi−1 ≤/integraldisplay1 0D(Φ0◦···◦Φi−1)(id+θ(Φi−id))dθ(Φi−id). Since, by ( 4.85), on D(β0 2,r0 2)×G∗, |D(Φ0◦···◦Φi−1)(id+θ(Φi−id))| ≤|DΦ0(Φ1◦···◦Φi−1)(id+θ(Φi−id))|···|DΦi−1(id+θ(Φi−id))| ≤(1+µ1 2∗)(1+µ1 2∗ 2)···(1+µ1 2∗ 2i−1)≤e1+1 2+···+1 2i−1≤e2, we have |Ψi−Ψi−1|D(β0 2,r0 2)×G∗≤e2|Φi−id|D(β0 2,r0 2)×G∗≤e2µ1 2∗ 2i, for all i=1,2,···.Thus,Ψνconverges uniformly on D(β0 2,r0 2)×G∗. We denote its limit by Ψ∗. Then Ψ∗=Ψ0+∞/summationdisplay i=1(Ψi−Ψi−1), (4.93) which is uniformly close to the identity. By a standard argum ent using the Whitney Extension Theorem, one can further show thatΨ∗is Whitney smooth with respect to ξ∈G∗(see [ 18], [24] ,[25], [32] for details). By Lemma 4.1,we see that eν,ων,˜hν,gν, ¯gνandζνare uniformly convergent and denote the limits by e∗,ω∗,˜h∗,g∗, ¯g∗andζ∗, respectively. It follows from Lemma 3.4that ∇g∗(0)=···=∇gν(0)=···=∇g0(ζ0)=0. Then, Nνconverge uniformly to N∗=e∗+/a\}b∇acketle{tω∗,y/a\}b∇acket∇i}ht+˜h∗(y)+g∗(z)+¯g∗(yız), with ˜h∗(y)=O(|y|2), g∗(z)=g(z)+∞/summationdisplay i=0γ(m+1)(2d)m ism−2 iµiO(|z|2) =g(z)+ε(m−2)(5m+4) 8m(m+1)O(|z|2), (4.94) ¯g∗(y,z,ξ)=/summationdisplay 2|ı|+||≤m,1≤|ı|,||¯gı(ξ)yız, where ( 4.94) follows from ( 4.92) and the deﬁnition of µ∗in Lemma 4.1. Hence Pν=H0◦Ψν−Nν converges uniformly to P∗=H0◦Ψ∗−N∗. Since |Pν|Dν≤γ(m+1)(2d)m ν sm νµν, 26the Cauchy estimate implies that |∂i y∂j zPν|D(sν 2,rν)≤γ(m+1)(2d)m ν s(m−2i−j) νµν, for all 2|i|+|j|≤m. By ( 4.86) and ( 4.87), it is easy to see that the right hand side of the above conver ges to 0 as ν→∞ . Hence, on D(0,r0 2)×G∗, ∂j y∂j zP∗|(y,z)=(0,0)=0, for all x∈Tn,ω∈G∗, 2|i|+|j|≤m. It follows that for each ξ∈G∗,Tn×{0}×{0}is an analytic, quasi-periodic, invariant n-torus associated to the Hamiltonian H∞=H◦Ψ∞with frequencyω∗. 4.3. Measure estimate Lemma 4.2. |G0\G∗|→0,asε→0. Proof. Since all the eigenvalues of normal direction are 0 in 0-th st ep, the measure estimate of G1in the ﬁrst step can be reduced to the estimate of /a\}b∇acketle{tk,ω/a\}b∇acket∇i}ht. Moreover, if ˜Sν ı≡0, the measure estimate of Gνin every step also can be reduced to the estimate of /a\}b∇acketle{tk,ω/a\}b∇acket∇i}ht. For details, see [ 8,24]. Otherwise, if ˜Sν ı/nequal0, the measure estimate of Gνis referred to [35]. For the sake of completeness, we give the outline of the pro of. Recall Rν+1 k(γν)={ξ∈Gν:|/a\}b∇acketle{tk,ων/a\}b∇acket∇i}ht|≤γν |k|τ,Aν⊤ıAν ı≤γ2 ν |k|2τI(2d)ı+, f or k∈Zn,Kν<|k|≤Kν+1,2|ı|+||≤m,1≤||} ⊂S1∪S 2, where S1={ξ∈Gν:|/a\}b∇acketle{tk,ων/a\}b∇acket∇i}ht|≤γν |k|τ}, S2={ξ∈Gν:Aν⊤ıAν ı≤γ2 ν |k|2τI(2d)ı+}. With Taylor series, Aı(ξ)=L(ξ0)Θ(ξ), where L(ξ0)=(Aı(ξ0),∂ξAı(ξ0),···,∂i ξAı(ξ0),/integraldisplay1 0(1−t)|i+1|∂i+1 ξAı(ξ0+tˆξ)dt), Θ(ξ)=(I,ˆξI,···,ˆξiI,ˆξi+1I)⊤, ˆξ=ξ−ξ0. Noting that ˜Sıcomes from the perturbation and (A1) , we have rank{Cj: 1≤j≤(2d)ı+}=(2d)ı+, (4.95) where Aj ıis the j-th column of Aı,Cjis a column of{∂i ξAj ı: 0≤|i|≤M}andAıis deﬁned as in ( 3.29). By ( 4.95) and the continuity of determinant, there is an orthogonal ma trixQξ0such that L(ξ)Qξ0=(E(ξ),F(ξ)),f orξ∈¯Gξ0, where E(ξ) is a (2 d)ı+×(2d)ı+nonsingular matrix on ¯Gξ0, and ¯Gξ0is the closure of a neighborhood Gξ0ofξ0. Moreover, Aı=L(ξ)Qξ0Q−1 ξ0Θ= (E(ξ),F(ξ))˜Θ, 27A⊤ı=˜Θ⊤(E(ξ),F(ξ))⊤, ˜Θ= Q−1 ξ0Θ=/parenleftigg˜Θ1 ˜Θ2/parenrightigg , where ˜Θ1is a (2 d)ı+×(2d)ı+-order matrix. Obviously, rank/parenleftiggE⊤EE⊤F F⊤EF⊤F/parenrightigg =(2d)ı+. Then there is an unitary matrix Uξsuch that U−1 ξ/parenleftiggE⊤EE⊤F F⊤EF⊤F/parenrightigg Uξ=/parenleftiggdiag(λ1,···,λ(2d)ı+) 0 0 0/parenrightigg , (4.96) whereλi, 1≤i≤(2d)ı+, is nonvanishing eigenvalue of/parenleftiggE⊤EE⊤F F⊤EF⊤F/parenrightigg . By Poincar´ e Separation Theorem (for example, p. 96, [ 40]), A⊤ıAı≥˜Θ⊤/parenleftiggE⊤EE⊤F F⊤EF⊤F/parenrightigg ˜Θ ≥˜Θ⊤/parenleftiggdiag(λ1,···,λ(2d)ı+) 0 0 0/parenrightigg ˜Θ ≥/parenleftig ˜Θ⊤ 1˜Θ⊤ 2/parenrightig/parenleftiggdiag(λ1,···,λ(2d)ı+) 0 0 0/parenrightigg/parenleftigg˜Θ1 ˜Θ2/parenrightigg ≥min imin ¯Oξ0λi˜Θ⊤ 1˜Θ1 ≥min imin ¯Oξ0λi(min j|ˆξj|)2M+2I(2d)ı+, where ”≥” is L¨ ower order (for speciﬁc deﬁnition, see [ 40]) and the last equality has been explicitly explained on pag e 12 of [ 35]. Hence, with ﬁnite cover theorem, we have |S2|=|{ξ∈G,0≤A⊤ıAı≤γ2 |k|2τI(2d)ı+}|≤cγ1 M+1 |k|τ M+1. Similarly, |S1|=|{ξ∈G,|/a\}b∇acketle{tk,ω(ξ)/a\}b∇acket∇i}ht≤γ |k|τ|≤cγ1 M+1 |k|τ M+1. Then|Rν+1|<γ1 M+1 0 |k|τ M+1. Consequently, |G0\G∗|=|∞/uniondisplay ν=0/uniondisplay Kν<|k|≤Kν+1Rν+1 k|≤∞/summationdisplay ν=0/summationdisplay Kν<|k|≤Kν+1γ1 M+1 0 |k|τ M+1→0,asε→0. 5. Appendix A. Proof of Proposition 1. 28Proof. Notice that ∇g(u,v)=(u|u|2l0−2,v|v|2k0−2),∇g(0,0)=0. For 0<δ< 1,Bδ(0) denotes the open ball centered at the origin with radius δ. We have that∇g(u,v)−∇g(0,0) is odd and unequal to zero on ∂Bδ(0), i.e., ∇g(−u,−v)−∇g(0,0)=(−u|u|2l0−2,−v|v|2k0−2)=−(∇g(u,v)−∇g(0,0)), and ∇g(u,v)−∇g(0,0)/nequal0,∀y∈∂Bδ(0). It follows from Borsuk’s theorem in [ 31] that deg(∇g(u,v)−∇g(0,0),Bδ(0),0)/nequal0. There existσ=1 and L=2 min{l0,k0}−1 such that |∇g(u,v)−∇g(0,0)|>σ|(u,v)|L. So, by Theorem 1, the results in Proposition 1hold. 6. Appendix B. Proof of Proposition 2 Proof. Note that the motion equation of ( 2.6) is ˙x=ω, ˙y=0, ˙u=v2, ˙v=−u2−ε2. Since for anyε/nequal0, the equation u2+ε2=0 has no real solution, we see that the Hamiltonian system doe s not admit any lower-dimensional torus. Let g(u,v)=1 3u3+1 3v3. By simple calculation, we have deg(∇g(u,v),Bδ(0),0)=0, which implies that (A0) fails. Hence our assumption (A0) is sharp to Melnikov’s persistence. Acknowledgments The second author (Li Yong) is supported by National Basic Re search Program of China (grant No. 2013CB834100), National Natural Science Foundation of China (grant No. 115 71065, 11171132, 12071175), and Natural Science Foundation of Jilin Province (grant No. 20200201253JC). 29References [1] V . I. Arnold, Proof of A.N. Kolmogorov’s theorem on the conservation of co nditionally periodic motions with a small variation in the H amiltonian , Uspehi Mat. Nauk. 18(1963), no. 5, 9-36 [2] J. Bourgain, Construction of quasi-periodic solutions for Hamiltonian perturbations of linear equations and applications to nonl inear PDE , Internat. Math. Res. Notices. 11(1994), 475-497 [3] J. Bourgain, On Melnikov’s persistency problem , Math. Res. Lett. 4(1997), 445-458 [4] H. W. Broer, H. Hanßmann, and J. G. You, On the destruction of resonant lagrangean tori in Hamiltoni an systems , Springer Proc. Math. Stat. 35(2013) [5] C. Q. Cheng, Lower dimensional invariant tori in the regions of instabil ity of nearly integrable Hamiltonian systems , Comm. Math. Phys. 203(1999), no. 2, 385-419 [6] L. Chierchia and D. B. Qian, Moser’s theorem for lower dimensional tori , J. Diﬀerential Equations 206(2004), no. 1, 55-93 [7] S. N. Chow, Y . Li, and Y . F. Yi, Persistence of invariant tori on submanifolds in Hamiltoni an systems , J. Nonlinear Sci. 12(2002), 585-617 [8] F. Z. Cong, T. K¨ upper, Y . Li, and J. G. You, KAM-type theorem on resonant surfaces for nearly integrabl e Hamiltonian systems , J. Nonlinear Sci. 10(2000), no. 1, 49-68 [9] R. de la Llave and L. Xu, Whiskered tori for presymplectic dynamical systems , J. Dynam. Diﬀerential Equatioins 33(2021), no. 1, 1-34 [10] A. Delshams and P. Guti´ errez, Eﬀective stability and KAM theory , J. Diﬀerential Equations 128(1996), no. 2, 415-490 [11] A. Delshams and P. Guti´ errez, Estimates on invariant tori near an elliptic equilibrium po int of a Hamiltonian system , J. Diﬀerential Equations 131(1996), no. 2, 277-303 [12] A. Delshams and P. Guti´ errez, Splitting potential and the Poincar´ e-Melnikov method for whiskered tori in Hamiltonian systems , J. Nonlinear Sci. 10(2000), no. 4, 433-476 [13] L. H. Eliasson, Perturbations of stable invariant tori for Hamiltonian sys tems, Ann. Scuola Norm. Sup. Pisa Cl. Sci. 15(1988), no. 1, 115-14 7 [14] L. H. Eliasson, Biasymptotic solutions of perturbed integrable Hamiltoni an systems , Bol. Soc. Brasil. Mat. 25(1994), no. 1, 57-76 [15] G. Gallatti and G. Gentile, Hyperbolic low-dimensional invariant tori and summations of divergent series , Comm. Math. Phys. 227(2002), no. 3, 421-460 [16] G. Gentile, Degenerate lower-dimensional tori under the Bryuno condit ion, Ergodic Theory Dynam. Systems 27(2007), no. 2, 427-457 [17] S. M. Graﬀ,On the continuation of hyperbolic invariant tori for Hamilt onian systems , J. Diﬀerential Equations 15(1974), 1-69 [18] Y . C. Han, Y . Li, and Y . F. Yi, Degenerate lower-dimensional tori in Hamiltonian systems , J. Diﬀerential Equations 227(2006), no. 2, 670-691 [19] S. Q. Hu and B. Liu, Completely degenerate lower-dimensional invariant tori f or Hamiltonian system , J. Diﬀerential Equations 266(2019), no. 11, 7459-7480 [20] `A. Jorba and J. Villanueva, On the persistence of lower dimensional invariant tori unde r quasi-periodic perturbations , J. Nonlinear Sci. 7(1997), no. 5, 427-473 [21] A. N. Kolmogorov, On preservation of conditionally periodic motions under a s mall change in the Hamiltonian function , In Dokl. Akad. Nauk SSSR 98(1954), 527-530 [22] S. B. Kuksin, Nearly integrable inﬁnite dimensional Hamiltonian system s, Lecture Notes in Mathematics, Springer-Verlag, Berlin, 1 993 [23] S. B. Kuksin, Hamiltonian perturbations of inﬁnite dimensional linear s ystems with an imaginary spectrum , Funktsional. Anal. i Prilozhen. 21(1987), no.3, 22-37 [24] Y . Li and Y . F. Yi, A quasi-periodic Poincar´ e’s theorem , Math. Ann. 326(2003), 649-690 [25] Y . Li and Y . F. Yi, Persistence of lower dimensional tori of general types in Ha miltonian systems , Trans. Amer. Math. Soc. 357(2005), no. 4, 1565-1600 [26] Y . Li and Y . F. Yi, Persistence of hyperbolic tori in Hamiltonian systems , J. Diﬀerential Equations 208(2005), no. 2, 344-387 [27] A. G. Medvedev, A. I. Neidhtadt, and D. V . Treschev, Lagrangian tori near resonances of near-integrable Hamilt onian systems , Nonlinearity. 28(2015), no. 7, 2105-2130 [28] V . K. Melnikov, On certain cases of conservation of almost periodic motions with a small change of the Hamiltonian function , Dokl. Akad. Nauk SSSR 165(1965), 1245-1248 [29] J. Moser, On invariant curves of area-preserving mapping of an annulu s, Nachr. Akad. Wiss. G¨ ottingen.II 1962(1962), 1-20 [30] J. Moser, Convergent series expansions for quasi-periodic motions , Math. Ann. 169(1967), 136-176 [31] D. Motreanu, V . V . Motreanu, and N. Papageorgiou, Topological and variational methods with applications to n onlinear boundary value problems , Springer Science+Business Media, LLC, 2014 [32] J. P¨ oschel, Integrability of Hamiltonian systems on Cantor-like sets , Comm. Pure Appl. Math. 35(1982), no. 5, 653-696 [33] J. P¨ oschel, On elliptic lower-dimensional tori in Hamiltonian systems , Math. Z. 202(1989), no. 4, 559-608 [34] W. C. Qian, Y . Li, and X. Yang, Multiscale KAM theorem for Hamiltonian systems , J. Diﬀerential Equations 266(2019), 70-86 [35] W. C. Qian, Y . Li, and X. Yang, Melnikov’s conditions in matrices , J. Dynam. Diﬀerential Equations (2020)32, no. 4, 1779-1795 [36] M. Rudnev and S. Wiggins, KAM theory near multiplicity one resonant surfaces in pertu rbations of a priori stable Hamiltonian systems , J. Nonlinear Sci. 7(1997), no. 2, 177-209 [37] D. A. Salamon, The Kolmogorov-Arnold-Moser theorem , Math. Phys. Electron. J. 10(2004), 1-37 [38] F. Takens, Singularities of vector ﬁelds , Inst. Hautes ´Etudes Sci. Publ. Math. 43(1974), 47-100 [39] D. V . Treshchev, The mechanism of destruction resonance tori in Hamiltonian systems , Math. USSR-Sb. 68(1991), no. 1, 181-203 [40] S. G. Wang, M. X. Wu and Z. Z. Jia, Matrix Inequality , Science Press, Beijing (2006) [41] C. E. Wayne, Periodic and quasi-periodic solutions of nonlinear wave eq uations via KAM theory , Comm. Math. Phys. 127(1990), no. 3, 479-528 [42] J. X. Xu, Persistence of elliptic lower dimensional invariant tori f or small perturbation of degenerate integrable Hamiltonia n systems , J. Math. Anal. Appl. 208(1997), no. 2, 372-387 [43] J. X. Xu and J. G. You, Persistence of hyperbolic-type degenerate lower-dimensi onal invariant tori with perscribed frequencies in Hamioto nian systems , Regul. Chaotic Dyn. 25(2020), no. 6, 616-650 30[44] L. Xu, Y . Li, and Y . F. Yi, Lower-dimensional tori in multi-scale nearly integrable H amiltonian systems , Ann. Henri Poincar´ e 18(2017), no. 1, 53-83 [45] J. G. You, A KAM theorem for hyperbolic-type degenerate lower dimensi onal tori in Hamiltonian systems , Comm. Math. Phys. 192(1998), no. 1, 145-168 [46] E. Zehnder, Generalized implicit function theorems with applications to some small divisor problems I and II , Comm. Pure Appl. Math. 28(1975), 91-140; 29(1976), no. 1, 49-111 31